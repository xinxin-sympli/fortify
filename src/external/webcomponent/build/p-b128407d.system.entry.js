var __extends=this&&this.__extends||function(){var e=function(t,r){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r]};return e(t,r)};return function(t,r){e(t,r);function n(){this.constructor=t}t.prototype=r===null?Object.create(r):(n.prototype=r.prototype,new n)}}();var __awaiter=this&&this.__awaiter||function(e,t,r,n){function i(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,o){function a(e){try{u(n.next(e))}catch(t){o(t)}}function s(e){try{u(n["throw"](e))}catch(t){o(t)}}function u(e){e.done?r(e.value):i(e.value).then(a,s)}u((n=n.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},n,i,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return u([e,t])}}function u(a){if(n)throw new TypeError("Generator is already executing.");while(r)try{if(n=1,i&&(o=a[0]&2?i["return"]:a[0]?i["throw"]||((o=i["return"])&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;if(i=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:r.label++;return{value:a[1],done:false};case 5:r.label++;i=a[1];a=[0];continue;case 7:a=r.ops.pop();r.trys.pop();continue;default:if(!(o=r.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){r=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){r.label=a[1];break}if(a[0]===6&&r.label<o[1]){r.label=o[1];o=a;break}if(o&&r.label<o[2]){r.label=o[2];r.ops.push(a);break}if(o[2])r.ops.pop();r.trys.pop();continue}a=t.call(e,r)}catch(s){a=[6,s];i=0}finally{n=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)n[i]=o[a];return n};System.register(["./p-3e023753.system.js","./p-3cd9855f.system.js","./p-b1a7d290.system.js"],(function(e,t){"use strict";var r,n,i,o,a,s,u,l,c,f,h;return{setters:[function(e){r=e.r;n=e.c;i=e.h;o=e.g;a=e.H},function(e){s=e.B;u=e.c;l=e.a;c=e.C},function(e){f=e.l;h=e.g}],execute:function(){var v=this;var p=/iPhone/i;var d=/iPod/i;var g=/iPad/i;var y=/\biOS-universal(?:.+)Mac\b/i;var m=/\bAndroid(?:.+)Mobile\b/i;var b=/Android/i;var k=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i;var B=/Silk/i;var w=/Windows Phone/i;var S=/\bWindows(?:.+)ARM\b/i;var _=/BlackBerry/i;var A=/BB10/i;var x=/Opera Mini/i;var N=/\b(CriOS|Chrome)(?:.+)Mobile/i;var C=/Mobile(?:.+)Firefox\b/i;var E=function(e){return typeof e!=="undefined"&&e.platform==="MacIntel"&&typeof e.maxTouchPoints==="number"&&e.maxTouchPoints>1&&typeof MSStream==="undefined"};function I(e){return function(t){return t.test(e)}}function O(e){var t={userAgent:"",platform:"",maxTouchPoints:0};if(!e&&typeof navigator!=="undefined"){t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}}else if(typeof e==="string"){t.userAgent=e}else if(e&&e.userAgent){t={userAgent:e.userAgent,platform:e.platform,maxTouchPoints:e.maxTouchPoints||0}}var r=t.userAgent;var n=r.split("[FBAN");if(typeof n[1]!=="undefined"){r=n[0]}n=r.split("Twitter");if(typeof n[1]!=="undefined"){r=n[0]}var i=I(r);var o={apple:{phone:i(p)&&!i(w),ipod:i(d),tablet:!i(p)&&(i(g)||E(t))&&!i(w),universal:i(y),device:(i(p)||i(d)||i(g)||i(y)||E(t))&&!i(w)},amazon:{phone:i(k),tablet:!i(k)&&i(B),device:i(k)||i(B)},android:{phone:!i(w)&&i(k)||!i(w)&&i(m),tablet:!i(w)&&!i(k)&&!i(m)&&(i(B)||i(b)),device:!i(w)&&(i(k)||i(B)||i(m)||i(b))||i(/\bokhttp\b/i)},windows:{phone:i(w),tablet:i(S),device:i(w)||i(S)},other:{blackberry:i(_),blackberry10:i(A),opera:i(x),firefox:i(C),chrome:i(N),device:i(_)||i(A)||i(x)||i(C)||i(N)},any:false,phone:false,tablet:false};o.any=o.apple.device||o.android.device||o.windows.device||o.other.device;o.phone=o.apple.phone||o.android.phone||o.windows.phone;o.tablet=o.apple.tablet||o.android.tablet||o.windows.tablet;return o}
/*! *****************************************************************************
            Copyright (c) Microsoft Corporation. All rights reserved.
            Licensed under the Apache License, Version 2.0 (the "License"); you may not use
            this file except in compliance with the License. You may obtain a copy of the
            License at http://www.apache.org/licenses/LICENSE-2.0

            THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
            KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
            WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
            MERCHANTABLITY OR NON-INFRINGEMENT.

            See the Apache Version 2.0 License for specific language governing permissions
            and limitations under the License.
            ***************************************************************************** */function L(e,t,r,n){var i=arguments.length,o=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,r,n);else for(var s=e.length-1;s>=0;s--)if(a=e[s])o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o;return i>3&&o&&Object.defineProperty(t,r,o),o}function D(e,t,r){if(e instanceof Object===false)return r;if(t in e)return e[t];return r}function H(e,t,r,n){if(t===void 0){t=0}if(r===void 0){r=e.byteLength-t}if(n===void 0){n=false}var i="";for(var o=0,a=new Uint8Array(e,t,r);o<a.length;o++){var s=a[o];var u=s.toString(16).toUpperCase();if(u.length===1)i+="0";i+=u;if(n)i+=" "}return i.trim()}function R(e,t,r,n){if(t instanceof ArrayBuffer===false){e.error='Wrong parameter: inputBuffer must be "ArrayBuffer"';return false}if(t.byteLength===0){e.error="Wrong parameter: inputBuffer has zero length";return false}if(r<0){e.error="Wrong parameter: inputOffset less than zero";return false}if(n<0){e.error="Wrong parameter: inputLength less than zero";return false}if(t.byteLength-r-n<0){e.error="End of input reached before message was fully decoded (inconsistent offset and length values)";return false}return true}function T(e,t){var r=0;if(e.length===1)return e[0];for(var n=e.length-1;n>=0;n--)r+=e[e.length-1-n]*Math.pow(2,t*n);return r}function U(e,t,r){if(r===void 0){r=-1}var n=r;var i=e;var o=0;var a=Math.pow(2,t);for(var s=1;s<8;s++){if(e<a){var u=void 0;if(n<0){u=new ArrayBuffer(s);o=s}else{if(n<s)return new ArrayBuffer(0);u=new ArrayBuffer(n);o=n}var l=new Uint8Array(u);for(var c=s-1;c>=0;c--){var f=Math.pow(2,c*t);l[o-c-1]=Math.floor(i/f);i-=l[o-c-1]*f}return u}a*=Math.pow(2,t)}return new ArrayBuffer(0)}function P(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=0;var n=0;for(var i=0,o=e;i<o.length;i++){var a=o[i];r+=a.byteLength}var s=new ArrayBuffer(r);var u=new Uint8Array(s);for(var l=0,c=e;l<c.length;l++){var a=c[l];u.set(new Uint8Array(a),n);n+=a.byteLength}return s}function j(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var r=0;var n=0;for(var i=0,o=e;i<o.length;i++){var a=o[i];r+=a.length}var s=new ArrayBuffer(r);var u=new Uint8Array(s);for(var l=0,c=e;l<c.length;l++){var a=c[l];u.set(a,n);n+=a.length}return u}function F(){var e=new Uint8Array(this.valueHex);if(this.valueHex.byteLength>=2){var t=e[0]===255&&e[1]&128;var r=e[0]===0&&(e[1]&128)===0;if(t||r)this.warnings.push("Needlessly long format")}var n=new ArrayBuffer(this.valueHex.byteLength);var i=new Uint8Array(n);for(var o=0;o<this.valueHex.byteLength;o++)i[o]=0;i[0]=e[0]&128;var a=T(i,8);var s=new ArrayBuffer(this.valueHex.byteLength);var u=new Uint8Array(s);for(var l=0;l<this.valueHex.byteLength;l++)u[l]=e[l];u[0]&=127;var c=T(u,8);return c-a}function V(e){var t=e<0?e*-1:e;var r=128;for(var n=1;n<8;n++){if(t<=r){if(e<0){var i=r-t;var o=U(i,8,n);var a=new Uint8Array(o);a[0]|=128;return o}var s=U(t,8,n);var u=new Uint8Array(s);if(u[0]&128){var l=s.slice(0);var c=new Uint8Array(l);s=new ArrayBuffer(s.byteLength+1);u=new Uint8Array(s);for(var f=0;f<l.byteLength;f++)u[f+1]=c[f];u[0]=0}return s}r*=Math.pow(2,8)}return new ArrayBuffer(0)}function M(e,t){if(e.byteLength!==t.byteLength)return false;var r=new Uint8Array(e);var n=new Uint8Array(t);for(var i=0;i<r.length;i++){if(r[i]!==n[i])return false}return true}function J(e,t){var r=e.toString(10);if(t<r.length)return"";var n=t-r.length;var i=new Array(n);for(var o=0;o<n;o++)i[o]="0";var a=i.join("");return a.concat(r)}var G=[new Uint8Array([1])];var z="0123456789";var W=function(){function e(e){if(e===void 0){e={}}this.blockLength=D(e,"blockLength",0);this.error=D(e,"error","");this.warnings=D(e,"warnings",[]);if("valueBeforeDecode"in e)this.valueBeforeDecode=e.valueBeforeDecode.slice(0);else this.valueBeforeDecode=new ArrayBuffer(0)}e.blockName=function(){return"baseBlock"};e.prototype.toJSON=function(){return{blockName:this.constructor.blockName(),blockLength:this.blockLength,error:this.error,warnings:this.warnings,valueBeforeDecode:H(this.valueBeforeDecode,0,this.valueBeforeDecode.byteLength)}};return e}();var q=function(e){return function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.isHexOnly=D(t,"isHexOnly",false);if("valueHex"in t)r.valueHex=t.valueHex.slice(0);else r.valueHex=new ArrayBuffer(0);return r}t.blockName=function(){return"hexBlock"};t.prototype.fromBER=function(e,t,r){if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);if(n.length===0){this.warnings.push("Zero buffer length");return t}this.valueHex=e.slice(t,t+r);this.blockLength=r;return t+r};t.prototype.toBER=function(e){if(e===void 0){e=false}if(this.isHexOnly!==true){this.error='Flag "isHexOnly" is not set, abort';return new ArrayBuffer(0)}if(e===true)return new ArrayBuffer(this.valueHex.byteLength);return this.valueHex.slice(0)};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.blockName=this.constructor.blockName();t.isHexOnly=this.isHexOnly;t.valueHex=H(this.valueHex,0,this.valueHex.byteLength);return t};return t}(e)};var $=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this)||this;if("idBlock"in t){r.isHexOnly=D(t.idBlock,"isHexOnly",false);r.valueHex=D(t.idBlock,"valueHex",new ArrayBuffer(0));r.tagClass=D(t.idBlock,"tagClass",-1);r.tagNumber=D(t.idBlock,"tagNumber",-1);r.isConstructed=D(t.idBlock,"isConstructed",false)}else{r.tagClass=-1;r.tagNumber=-1;r.isConstructed=false}return r}t.blockName=function(){return"identificationBlock"};t.prototype.toBER=function(e){if(e===void 0){e=false}var t=0;var r;var n;switch(this.tagClass){case 1:t|=0;break;case 2:t|=64;break;case 3:t|=128;break;case 4:t|=192;break;default:this.error="Unknown tag class";return new ArrayBuffer(0)}if(this.isConstructed)t|=32;if(this.tagNumber<31&&!this.isHexOnly){r=new ArrayBuffer(1);n=new Uint8Array(r);if(!e){var i=this.tagNumber;i&=31;t|=i;n[0]=t}return r}if(this.isHexOnly===false){var o=U(this.tagNumber,7);var a=new Uint8Array(o);var s=o.byteLength;r=new ArrayBuffer(s+1);n=new Uint8Array(r);n[0]=t|31;if(!e){for(var u=0;u<s-1;u++)n[u+1]=a[u]|128;n[s]=a[s-1]}return r}r=new ArrayBuffer(this.valueHex.byteLength+1);n=new Uint8Array(r);n[0]=t|31;if(e===false){var l=new Uint8Array(this.valueHex);for(var u=0;u<l.length-1;u++)n[u+1]=l[u]|128;n[this.valueHex.byteLength]=l[l.length-1]}return r};t.prototype.fromBER=function(e,t,r){if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);if(n.length===0){this.error="Zero buffer length";return-1}var i=n[0]&192;switch(i){case 0:this.tagClass=1;break;case 64:this.tagClass=2;break;case 128:this.tagClass=3;break;case 192:this.tagClass=4;break;default:this.error="Unknown tag class";return-1}this.isConstructed=(n[0]&32)===32;this.isHexOnly=false;var o=n[0]&31;if(o!==31){this.tagNumber=o;this.blockLength=1}else{var a=1;this.valueHex=new ArrayBuffer(255);var s=255;var u=new Uint8Array(this.valueHex);while(n[a]&128){u[a-1]=n[a]&127;a++;if(a>=n.length){this.error="End of input reached before message was fully decoded";return-1}if(a===s){s+=255;var l=new ArrayBuffer(s);var c=new Uint8Array(l);for(var f=0;f<u.length;f++)c[f]=u[f];this.valueHex=new ArrayBuffer(s);u=new Uint8Array(this.valueHex)}}this.blockLength=a+1;u[a-1]=n[a]&127;var h=new ArrayBuffer(a);var v=new Uint8Array(h);for(var f=0;f<a;f++)v[f]=u[f];this.valueHex=new ArrayBuffer(a);u=new Uint8Array(this.valueHex);u.set(v);if(this.blockLength<=9)this.tagNumber=T(u,7);else{this.isHexOnly=true;this.warnings.push("Tag too long, represented as hex-coded")}}if(this.tagClass===1&&this.isConstructed){switch(this.tagNumber){case 1:case 2:case 5:case 6:case 9:case 13:case 14:case 23:case 24:case 31:case 32:case 33:case 34:this.error="Constructed encoding used for primitive type";return-1}}return t+this.blockLength};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.blockName=this.constructor.blockName();t.tagClass=this.tagClass;t.tagNumber=this.tagNumber;t.isConstructed=this.isConstructed;return t};return t}(q(W));var Z=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this)||this;if("lenBlock"in t){r.isIndefiniteForm=D(t.lenBlock,"isIndefiniteForm",false);r.longFormUsed=D(t.lenBlock,"longFormUsed",false);r.length=D(t.lenBlock,"length",0)}else{r.isIndefiniteForm=false;r.longFormUsed=false;r.length=0}return r}t.blockName=function(){return"lengthBlock"};t.prototype.fromBER=function(e,t,r){if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);if(n.length===0){this.error="Zero buffer length";return-1}if(n[0]===255){this.error="Length block 0xFF is reserved by standard";return-1}this.isIndefiniteForm=n[0]===128;if(this.isIndefiniteForm===true){this.blockLength=1;return t+this.blockLength}this.longFormUsed=!!(n[0]&128);if(this.longFormUsed===false){this.length=n[0];this.blockLength=1;return t+this.blockLength}var i=n[0]&127;if(i>8){this.error="Too big integer";return-1}if(i+1>n.length){this.error="End of input reached before message was fully decoded";return-1}var o=new Uint8Array(i);for(var a=0;a<i;a++)o[a]=n[a+1];if(o[i-1]===0)this.warnings.push("Needlessly long encoded length");this.length=T(o,8);if(this.longFormUsed&&this.length<=127)this.warnings.push("Unneccesary usage of long length form");this.blockLength=i+1;return t+this.blockLength};t.prototype.toBER=function(e){if(e===void 0){e=false}var t;var r;if(this.length>127)this.longFormUsed=true;if(this.isIndefiniteForm){t=new ArrayBuffer(1);if(e===false){r=new Uint8Array(t);r[0]=128}return t}if(this.longFormUsed===true){var n=U(this.length,8);if(n.byteLength>127){this.error="Too big length";return new ArrayBuffer(0)}t=new ArrayBuffer(n.byteLength+1);if(e===true)return t;var i=new Uint8Array(n);r=new Uint8Array(t);r[0]=n.byteLength|128;for(var o=0;o<n.byteLength;o++)r[o+1]=i[o];return t}t=new ArrayBuffer(1);if(e===false){r=new Uint8Array(t);r[0]=this.length}return t};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.blockName=this.constructor.blockName();t.isIndefiniteForm=this.isIndefiniteForm;t.longFormUsed=this.longFormUsed;t.length=this.length;return t};return t}(W);var K=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}return e.call(this,t)||this}t.blockName=function(){return"valueBlock"};t.prototype.fromBER=function(e,t,r){throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')};t.prototype.toBER=function(e){if(e===void 0){e=false}throw TypeError('User need to make a specific function in a class which extends "ValueBlock"')};return t}(W);var Y=function(e){__extends(t,e);function t(t,r){if(t===void 0){t={}}if(r===void 0){r=K}var n=e.call(this,t)||this;if("name"in t)n.name=t.name;if("optional"in t)n.optional=t.optional;if("primitiveSchema"in t)n.primitiveSchema=t.primitiveSchema;n.idBlock=new $(t);n.lenBlock=new Z(t);n.valueBlock=new r(t);return n}t.blockName=function(){return"BaseBlock"};t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.toBER=function(e){if(e===void 0){e=false}var t;var r=this.idBlock.toBER(e);var n=this.valueBlock.toBER(true);this.lenBlock.length=n.byteLength;var i=this.lenBlock.toBER(e);t=P(r,i);var o;if(e===false)o=this.valueBlock.toBER(e);else o=new ArrayBuffer(this.lenBlock.length);t=P(t,o);if(this.lenBlock.isIndefiniteForm===true){var a=new ArrayBuffer(2);if(e===false){var s=new Uint8Array(a);s[0]=0;s[1]=0}t=P(t,a)}return t};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.idBlock=this.idBlock.toJSON();t.lenBlock=this.lenBlock.toJSON();t.valueBlock=this.valueBlock.toJSON();if("name"in this)t.name=this.name;if("optional"in this)t.optional=this.optional;if("primitiveSchema"in this)t.primitiveSchema=this.primitiveSchema.toJSON();return t};return t}(W);var Q=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;if("valueHex"in t)r.valueHex=t.valueHex.slice(0);else r.valueHex=new ArrayBuffer(0);r.isHexOnly=D(t,"isHexOnly",true);return r}t.prototype.fromBER=function(e,t,r){if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);if(n.length===0){this.warnings.push("Zero buffer length");return t}this.valueHex=new ArrayBuffer(n.length);var i=new Uint8Array(this.valueHex);for(var o=0;o<n.length;o++)i[o]=n[o];this.blockLength=r;return t+r};t.prototype.toBER=function(e){if(e===void 0){e=false}return this.valueHex.slice(0)};t.blockName=function(){return"PrimitiveValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.valueHex=H(this.valueHex,0,this.valueHex.byteLength);t.isHexOnly=this.isHexOnly;return t};return t}(K);var X=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,Q)||this;r.idBlock.isConstructed=false;return r}t.blockName=function(){return"PRIMITIVE"};return t}(Y);var ee=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.value=D(t,"value",[]);r.isIndefiniteForm=D(t,"isIndefiniteForm",false);return r}t.prototype.fromBER=function(e,t,r){var n=t;var i=r;if(R(this,e,t,r)===false)return-1;var o=new Uint8Array(e,t,r);if(o.length===0){this.warnings.push("Zero buffer length");return t}function a(e,t){if(e===true)return 1;return t}var s=t;while(a(this.isIndefiniteForm,r)>0){var u=Ke(e,s,r);if(u.offset===-1){this.error=u.result.error;this.warnings.concat(u.result.warnings);return-1}s=u.offset;this.blockLength+=u.result.blockLength;r-=u.result.blockLength;this.value.push(u.result);if(this.isIndefiniteForm===true&&u.result.constructor.blockName()===ne.blockName())break}if(this.isIndefiniteForm===true){if(this.value[this.value.length-1].constructor.blockName()===ne.blockName())this.value.pop();else this.warnings.push("No EndOfContent block encoded")}this.valueBeforeDecode=e.slice(n,n+i);return s};t.prototype.toBER=function(e){if(e===void 0){e=false}var t=new ArrayBuffer(0);for(var r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);t=P(t,n)}return t};t.blockName=function(){return"ConstructedValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(n){}t.isIndefiniteForm=this.isIndefiniteForm;t.value=[];for(var r=0;r<this.value.length;r++)t.value.push(this.value[r].toJSON());return t};return t}(K);var te=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,ee)||this;r.idBlock.isConstructed=true;return r}t.blockName=function(){return"CONSTRUCTED"};t.prototype.fromBER=function(e,t,r){this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};return t}(Y);var re=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}return e.call(this,t)||this}t.prototype.fromBER=function(e,t,r){return t};t.prototype.toBER=function(e){if(e===void 0){e=false}return new ArrayBuffer(0)};t.blockName=function(){return"EndOfContentValueBlock"};return t}(K);var ne=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,re)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=0;return r}t.blockName=function(){return"EndOfContent"};return t}(Y);var ie=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.value=D(t,"value",false);r.isHexOnly=D(t,"isHexOnly",false);if("valueHex"in t)r.valueHex=t.valueHex.slice(0);else{r.valueHex=new ArrayBuffer(1);if(r.value===true){var n=new Uint8Array(r.valueHex);n[0]=255}}return r}t.prototype.fromBER=function(e,t,r){if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);if(r>1)this.warnings.push("Boolean value encoded in more then 1 octet");this.isHexOnly=true;this.valueHex=new ArrayBuffer(n.length);var i=new Uint8Array(this.valueHex);for(var o=0;o<n.length;o++)i[o]=n[o];if(F.call(this)!==0)this.value=true;else this.value=false;this.blockLength=r;return t+r};t.prototype.toBER=function(e){if(e===void 0){e=false}return this.valueHex};t.blockName=function(){return"BooleanValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.value=this.value;t.isHexOnly=this.isHexOnly;t.valueHex=H(this.valueHex,0,this.valueHex.byteLength);return t};return t}(K);var oe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,ie)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=1;return r}t.blockName=function(){return"Boolean"};return t}(Y);var ae=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=16;return r}t.blockName=function(){return"Sequence"};return t}(te);var se=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=17;return r}t.blockName=function(){return"Set"};return t}(te);var ue=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,W)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=5;return r}t.blockName=function(){return"Null"};t.prototype.fromBER=function(e,t,r){if(this.lenBlock.length>0)this.warnings.push("Non-zero length of value block for Null type");if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;this.blockLength+=r;if(t+r>e.byteLength){this.error="End of input reached before message was fully decoded (inconsistent offset and length values)";return-1}return t+r};t.prototype.toBER=function(e){if(e===void 0){e=false}var t=new ArrayBuffer(2);if(e===true)return t;var r=new Uint8Array(t);r[0]=5;r[1]=0;return t};return t}(Y);var le=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.isConstructed=D(t,"isConstructed",false);return r}t.prototype.fromBER=function(t,r,n){var i=0;if(this.isConstructed===true){this.isHexOnly=false;i=ee.prototype.fromBER.call(this,t,r,n);if(i===-1)return i;for(var o=0;o<this.value.length;o++){var a=this.value[o].constructor.blockName();if(a===ne.blockName()){if(this.isIndefiniteForm===true)break;else{this.error="EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only";return-1}}if(a!==ce.blockName()){this.error="OCTET STRING may consists of OCTET STRINGs only";return-1}}}else{this.isHexOnly=true;i=e.prototype.fromBER.call(this,t,r,n);this.blockLength=n}return i};t.prototype.toBER=function(e){if(e===void 0){e=false}if(this.isConstructed===true)return ee.prototype.toBER.call(this,e);var t=new ArrayBuffer(this.valueHex.byteLength);if(e===true)return t;if(this.valueHex.byteLength===0)return t;t=this.valueHex.slice(0);return t};t.blockName=function(){return"OctetStringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.isConstructed=this.isConstructed;t.isHexOnly=this.isHexOnly;t.valueHex=H(this.valueHex,0,this.valueHex.byteLength);return t};return t}(q(ee));var ce=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,le)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=4;return r}t.prototype.fromBER=function(t,r,n){this.valueBlock.isConstructed=this.idBlock.isConstructed;this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;if(n===0){if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;return r}return e.prototype.fromBER.call(this,t,r,n)};t.blockName=function(){return"OctetString"};t.prototype.isEqual=function(e){if(e instanceof t===false)return false;if(JSON.stringify(this)!==JSON.stringify(e))return false;return true};return t}(Y);var fe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.unusedBits=D(t,"unusedBits",0);r.isConstructed=D(t,"isConstructed",false);r.blockLength=r.valueHex.byteLength;return r}t.prototype.fromBER=function(e,t,r){if(r===0)return t;var n=-1;if(this.isConstructed===true){n=ee.prototype.fromBER.call(this,e,t,r);if(n===-1)return n;for(var i=0;i<this.value.length;i++){var o=this.value[i].constructor.blockName();if(o===ne.blockName()){if(this.isIndefiniteForm===true)break;else{this.error="EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only";return-1}}if(o!==he.blockName()){this.error="BIT STRING may consists of BIT STRINGs only";return-1}if(this.unusedBits>0&&this.value[i].valueBlock.unusedBits>0){this.error='Usign of "unused bits" inside constructive BIT STRING allowed for least one only';return-1}this.unusedBits=this.value[i].valueBlock.unusedBits;if(this.unusedBits>7){this.error="Unused bits for BitString must be in range 0-7";return-1}}return n}if(R(this,e,t,r)===false)return-1;var a=new Uint8Array(e,t,r);this.unusedBits=a[0];if(this.unusedBits>7){this.error="Unused bits for BitString must be in range 0-7";return-1}this.valueHex=new ArrayBuffer(a.length-1);var s=new Uint8Array(this.valueHex);for(var i=0;i<r-1;i++)s[i]=a[i+1];this.blockLength=a.length;return t+r};t.prototype.toBER=function(e){if(e===void 0){e=false}if(this.isConstructed===true)return ee.prototype.toBER.call(this,e);if(e===true)return new ArrayBuffer(this.valueHex.byteLength+1);if(this.valueHex.byteLength===0)return new ArrayBuffer(0);var t=new Uint8Array(this.valueHex);var r=new ArrayBuffer(this.valueHex.byteLength+1);var n=new Uint8Array(r);n[0]=this.unusedBits;for(var i=0;i<this.valueHex.byteLength;i++)n[i+1]=t[i];return r};t.blockName=function(){return"BitStringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.unusedBits=this.unusedBits;t.isConstructed=this.isConstructed;t.isHexOnly=this.isHexOnly;t.valueHex=H(this.valueHex,0,this.valueHex.byteLength);return t};return t}(q(ee));var he=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,fe)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=3;return r}t.blockName=function(){return"BitString"};t.prototype.fromBER=function(t,r,n){if(n===0)return r;this.valueBlock.isConstructed=this.idBlock.isConstructed;this.valueBlock.isIndefiniteForm=this.lenBlock.isIndefiniteForm;return e.prototype.fromBER.call(this,t,r,n)};t.prototype.isEqual=function(e){if(e instanceof t===false)return false;if(JSON.stringify(this)!==JSON.stringify(e))return false;return true};return t}(Y);var ve=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;if("value"in t)r.valueDec=t.value;return r}Object.defineProperty(t.prototype,"valueHex",{get:function(){return this._valueHex},set:function(e){this._valueHex=e.slice(0);if(e.byteLength>=4){this.warnings.push("Too big Integer for decoding, hex only");this.isHexOnly=true;this._valueDec=0}else{this.isHexOnly=false;if(e.byteLength>0)this._valueDec=F.call(this)}},enumerable:true,configurable:true});Object.defineProperty(t.prototype,"valueDec",{get:function(){return this._valueDec},set:function(e){this._valueDec=e;this.isHexOnly=false;this._valueHex=V(e)},enumerable:true,configurable:true});t.prototype.fromDER=function(e,t,r,n){if(n===void 0){n=0}var i=this.fromBER(e,t,r);if(i===-1)return i;var o=new Uint8Array(this._valueHex);if(o[0]===0&&(o[1]&128)!==0){var a=new ArrayBuffer(this._valueHex.byteLength-1);var s=new Uint8Array(a);s.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1));this._valueHex=a.slice(0)}else{if(n!==0){if(this._valueHex.byteLength<n){if(n-this._valueHex.byteLength>1)n=this._valueHex.byteLength+1;var a=new ArrayBuffer(n);var s=new Uint8Array(a);s.set(o,n-this._valueHex.byteLength);this._valueHex=a.slice(0)}}}return i};t.prototype.toDER=function(e){if(e===void 0){e=false}var t=new Uint8Array(this._valueHex);switch(true){case(t[0]&128)!==0:{var r=new ArrayBuffer(this._valueHex.byteLength+1);var n=new Uint8Array(r);n[0]=0;n.set(t,1);this._valueHex=r.slice(0)}break;case t[0]===0&&(t[1]&128)===0:{var r=new ArrayBuffer(this._valueHex.byteLength-1);var n=new Uint8Array(r);n.set(new Uint8Array(this._valueHex,1,this._valueHex.byteLength-1));this._valueHex=r.slice(0)}break}return this.toBER(e)};t.prototype.fromBER=function(t,r,n){var i=e.prototype.fromBER.call(this,t,r,n);if(i===-1)return i;this.blockLength=n;return r+n};t.prototype.toBER=function(e){if(e===void 0){e=false}return this.valueHex.slice(0)};t.blockName=function(){return"IntegerValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.valueDec=this.valueDec;return t};t.prototype.toString=function(){function e(e,t){var r=new Uint8Array([0]);var n=new Uint8Array(e);var i=new Uint8Array(t);var o=n.slice(0);var a=o.length-1;var s=i.slice(0);var u=s.length-1;var l=0;var c=u<a?a:u;var f=0;for(var h=c;h>=0;h--,f++){switch(true){case f<s.length:l=o[a-f]+s[u-f]+r[0];break;default:l=o[a-f]+r[0]}r[0]=l/10;switch(true){case f>=o.length:o=j(new Uint8Array([l%10]),o);break;default:o[a-f]=l%10}}if(r[0]>0)o=j(r,o);return o.slice(0)}function t(e){if(e>=G.length){for(var t=G.length;t<=e;t++){var r=new Uint8Array([0]);var n=G[t-1].slice(0);for(var i=n.length-1;i>=0;i--){var o=new Uint8Array([(n[i]<<1)+r[0]]);r[0]=o[0]/10;n[i]=o[0]%10}if(r[0]>0)n=j(r,n);G.push(n)}}return G[e]}function r(e,t){var r=0;var n=new Uint8Array(e);var i=new Uint8Array(t);var o=n.slice(0);var a=o.length-1;var s=i.slice(0);var u=s.length-1;var l;var c=0;for(var f=u;f>=0;f--,c++){l=o[a-c]-s[u-c]-r;switch(true){case l<0:r=1;o[a-c]=l+10;break;default:r=0;o[a-c]=l}}if(r>0){for(var f=a-u+1;f>=0;f--,c++){l=o[a-c]-r;if(l<0){r=1;o[a-c]=l+10}else{r=0;o[a-c]=l;break}}}return o.slice()}var n=this._valueHex.byteLength*8-1;var i=new Uint8Array(this._valueHex.byteLength*8/3);var o=0;var a;var s=new Uint8Array(this._valueHex);var u="";var l=false;for(var c=this._valueHex.byteLength-1;c>=0;c--){a=s[c];for(var f=0;f<8;f++){if((a&1)===1){switch(o){case n:i=r(t(o),i);u="-";break;default:i=e(i,t(o))}}o++;a>>=1}}for(var f=0;f<i.length;f++){if(i[f])l=true;if(l)u+=z.charAt(i[f])}if(l===false)u+=z.charAt(0);return u};return t}(q(K));var pe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,ve)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=2;return r}t.blockName=function(){return"Integer"};t.prototype.isEqual=function(e){if(e instanceof t){if(this.valueBlock.isHexOnly&&e.valueBlock.isHexOnly)return M(this.valueBlock.valueHex,e.valueBlock.valueHex);if(this.valueBlock.isHexOnly===e.valueBlock.isHexOnly)return this.valueBlock.valueDec===e.valueBlock.valueDec;return false}if(e instanceof ArrayBuffer)return M(this.valueBlock.valueHex,e);return false};t.prototype.convertToDER=function(){var e=new t({valueHex:this.valueBlock.valueHex});e.valueBlock.toDER();return e};t.prototype.convertFromDER=function(){var e=this.valueBlock.valueHex.byteLength%2?this.valueBlock.valueHex.byteLength+1:this.valueBlock.valueHex.byteLength;var r=new t({valueHex:this.valueBlock.valueHex});r.valueBlock.fromDER(r.valueBlock.valueHex,0,r.valueBlock.valueHex.byteLength,e);return r};return t}(Y);var de=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=10;return r}t.blockName=function(){return"Enumerated"};return t}(pe);var ge=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.valueDec=D(t,"valueDec",-1);r.isFirstSid=D(t,"isFirstSid",false);return r}t.blockName=function(){return"sidBlock"};t.prototype.fromBER=function(e,t,r){if(r===0)return t;if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);var i=new Uint8Array(this.valueHex);for(var o=0;o<r;o++){i[o]=n[o]&127;this.blockLength++;if((n[o]&128)===0)break}var a=new ArrayBuffer(this.blockLength);var s=new Uint8Array(a);for(var o=0;o<this.blockLength;o++)s[o]=i[o];this.valueHex=a.slice(0);i=new Uint8Array(this.valueHex);if((n[this.blockLength-1]&128)!==0){this.error="End of input reached before message was fully decoded";return-1}if(i[0]===0)this.warnings.push("Needlessly long format of SID encoding");if(this.blockLength<=8)this.valueDec=T(i,7);else{this.isHexOnly=true;this.warnings.push("Too big SID for decoding, hex only")}return t+this.blockLength};t.prototype.toBER=function(e){if(e===void 0){e=false}var t;var r;if(this.isHexOnly){if(e===true)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength);r=new Uint8Array(t);for(var i=0;i<this.blockLength-1;i++)r[i]=n[i]|128;r[this.blockLength-1]=n[this.blockLength-1];return t}var o=U(this.valueDec,7);if(o.byteLength===0){this.error="Error during encoding SID value";return new ArrayBuffer(0)}t=new ArrayBuffer(o.byteLength);if(e===false){var a=new Uint8Array(o);r=new Uint8Array(t);for(var i=0;i<o.byteLength-1;i++)r[i]=a[i]|128;r[o.byteLength-1]=a[o.byteLength-1]}return t};t.prototype.toString=function(){var e="";if(this.isHexOnly===true)e=H(this.valueHex,0,this.valueHex.byteLength);else{if(this.isFirstSid){var t=this.valueDec;if(this.valueDec<=39)e="0.";else{if(this.valueDec<=79){e="1.";t-=40}else{e="2.";t-=80}}e+=t.toString()}else e=this.valueDec.toString()}return e};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.valueDec=this.valueDec;t.isFirstSid=this.isFirstSid;return t};return t}(q(W));var ye=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.fromString(D(t,"value",""));return r}t.prototype.fromBER=function(e,t,r){var n=t;while(r>0){var i=new ge;n=i.fromBER(e,n,r);if(n===-1){this.blockLength=0;this.error=i.error;return n}if(this.value.length===0)i.isFirstSid=true;this.blockLength+=i.blockLength;r-=i.blockLength;this.value.push(i)}return n};t.prototype.toBER=function(e){if(e===void 0){e=false}var t=new ArrayBuffer(0);for(var r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(n.byteLength===0){this.error=this.value[r].error;return new ArrayBuffer(0)}t=P(t,n)}return t};t.prototype.fromString=function(e){this.value=[];var t=0;var r=0;var n="";var i=false;do{r=e.indexOf(".",t);if(r===-1)n=e.substr(t);else n=e.substr(t,r-t);t=r+1;if(i){var o=this.value[0];var a=0;switch(o.valueDec){case 0:break;case 1:a=40;break;case 2:a=80;break;default:this.value=[];return false}var s=parseInt(n,10);if(isNaN(s))return true;o.valueDec=s+a;i=false}else{var o=new ge;o.valueDec=parseInt(n,10);if(isNaN(o.valueDec))return true;if(this.value.length===0){o.isFirstSid=true;i=true}this.value.push(o)}}while(r!==-1);return true};t.prototype.toString=function(){var e="";var t=false;for(var r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();if(r!==0)e=e+".";if(t){n="{"+n+"}";if(this.value[r].isFirstSid)e="2.{"+n+" - 80}";else e+=n}else e+=n}return e};t.blockName=function(){return"ObjectIdentifierValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(n){}t.value=this.toString();t.sidArray=[];for(var r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t};return t}(K);var me=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,ye)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=6;return r}t.blockName=function(){return"ObjectIdentifier"};return t}(Y);var be=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.isHexOnly=true;r.value="";return r}t.blockName=function(){return"Utf8StringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.value=this.value;return t};return t}(q(W));var ke=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,be)||this;if("value"in t)r.fromString(t.value);r.idBlock.tagClass=1;r.idBlock.tagNumber=12;return r}t.blockName=function(){return"Utf8String"};t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e));try{this.valueBlock.value=decodeURIComponent(escape(this.valueBlock.value))}catch(t){this.warnings.push('Error during "decodeURIComponent": '+t+", using raw string")}};t.prototype.fromString=function(e){var t=unescape(encodeURIComponent(e));var r=t.length;this.valueBlock.valueHex=new ArrayBuffer(r);var n=new Uint8Array(this.valueBlock.valueHex);for(var i=0;i<r;i++)n[i]=t.charCodeAt(i);this.valueBlock.value=e};return t}(Y);var Be=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.valueDec=D(t,"valueDec",-1);return r}t.blockName=function(){return"relativeSidBlock"};t.prototype.fromBER=function(e,t,r){if(r===0)return t;if(R(this,e,t,r)===false)return-1;var n=new Uint8Array(e,t,r);this.valueHex=new ArrayBuffer(r);var i=new Uint8Array(this.valueHex);for(var o=0;o<r;o++){i[o]=n[o]&127;this.blockLength++;if((n[o]&128)===0)break}var a=new ArrayBuffer(this.blockLength);var s=new Uint8Array(a);for(var o=0;o<this.blockLength;o++)s[o]=i[o];this.valueHex=a.slice(0);i=new Uint8Array(this.valueHex);if((n[this.blockLength-1]&128)!==0){this.error="End of input reached before message was fully decoded";return-1}if(i[0]===0)this.warnings.push("Needlessly long format of SID encoding");if(this.blockLength<=8)this.valueDec=T(i,7);else{this.isHexOnly=true;this.warnings.push("Too big SID for decoding, hex only")}return t+this.blockLength};t.prototype.toBER=function(e){if(e===void 0){e=false}var t;var r;if(this.isHexOnly){if(e===true)return new ArrayBuffer(this.valueHex.byteLength);var n=new Uint8Array(this.valueHex);t=new ArrayBuffer(this.blockLength);r=new Uint8Array(t);for(var i=0;i<this.blockLength-1;i++)r[i]=n[i]|128;r[this.blockLength-1]=n[this.blockLength-1];return t}var o=U(this.valueDec,7);if(o.byteLength===0){this.error="Error during encoding SID value";return new ArrayBuffer(0)}t=new ArrayBuffer(o.byteLength);if(e===false){var a=new Uint8Array(o);r=new Uint8Array(t);for(var i=0;i<o.byteLength-1;i++)r[i]=a[i]|128;r[o.byteLength-1]=a[o.byteLength-1]}return t};t.prototype.toString=function(){var e="";if(this.isHexOnly===true)e=H(this.valueHex,0,this.valueHex.byteLength);else{e=this.valueDec.toString()}return e};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.valueDec=this.valueDec;return t};return t}(q(W));var we=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.fromString(D(t,"value",""));return r}t.prototype.fromBER=function(e,t,r){var n=t;while(r>0){var i=new Be;n=i.fromBER(e,n,r);if(n===-1){this.blockLength=0;this.error=i.error;return n}this.blockLength+=i.blockLength;r-=i.blockLength;this.value.push(i)}return n};t.prototype.toBER=function(e){if(e===void 0){e=false}var t=new ArrayBuffer(0);for(var r=0;r<this.value.length;r++){var n=this.value[r].toBER(e);if(n.byteLength===0){this.error=this.value[r].error;return new ArrayBuffer(0)}t=P(t,n)}return t};t.prototype.fromString=function(e){this.value=[];var t=0;var r=0;var n="";do{r=e.indexOf(".",t);if(r===-1)n=e.substr(t);else n=e.substr(t,r-t);t=r+1;var i=new Be;i.valueDec=parseInt(n,10);if(isNaN(i.valueDec))return true;this.value.push(i)}while(r!==-1);return true};t.prototype.toString=function(){var e="";var t=false;for(var r=0;r<this.value.length;r++){t=this.value[r].isHexOnly;var n=this.value[r].toString();if(r!==0)e=e+".";if(t){n="{"+n+"}";e+=n}else e+=n}return e};t.blockName=function(){return"RelativeObjectIdentifierValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(n){}t.value=this.toString();t.sidArray=[];for(var r=0;r<this.value.length;r++)t.sidArray.push(this.value[r].toJSON());return t};return t}(K);var Se=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,we)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=13;return r}t.blockName=function(){return"RelativeObjectIdentifier"};return t}(Y);var _e=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.isHexOnly=true;r.value="";return r}t.blockName=function(){return"BmpStringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.value=this.value;return t};return t}(q(W));var Ae=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,_e)||this;if("value"in t)r.fromString(t.value);r.idBlock.tagClass=1;r.idBlock.tagNumber=30;return r}t.blockName=function(){return"BmpString"};t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){var t=e.slice(0);var r=new Uint8Array(t);for(var n=0;n<r.length;n+=2){var i=r[n];r[n]=r[n+1];r[n+1]=i}this.valueBlock.value=String.fromCharCode.apply(null,new Uint16Array(t))};t.prototype.fromString=function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t*2);var r=new Uint8Array(this.valueBlock.valueHex);for(var n=0;n<t;n++){var i=U(e.charCodeAt(n),8);var o=new Uint8Array(i);if(o.length>2)continue;var a=2-o.length;for(var s=o.length-1;s>=0;s--)r[n*2+s+a]=o[s]}this.valueBlock.value=e};return t}(Y);var xe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.isHexOnly=true;r.value="";return r}t.blockName=function(){return"UniversalStringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.value=this.value;return t};return t}(q(W));var Ne=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,xe)||this;if("value"in t)r.fromString(t.value);r.idBlock.tagClass=1;r.idBlock.tagNumber=28;return r}t.blockName=function(){return"UniversalString"};t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){var t=e.slice(0);var r=new Uint8Array(t);for(var n=0;n<r.length;n+=4){r[n]=r[n+3];r[n+1]=r[n+2];r[n+2]=0;r[n+3]=0}this.valueBlock.value=String.fromCharCode.apply(null,new Uint32Array(t))};t.prototype.fromString=function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t*4);var r=new Uint8Array(this.valueBlock.valueHex);for(var n=0;n<t;n++){var i=U(e.charCodeAt(n),8);var o=new Uint8Array(i);if(o.length>4)continue;var a=4-o.length;for(var s=o.length-1;s>=0;s--)r[n*4+s+a]=o[s]}this.valueBlock.value=e};return t}(Y);var Ce=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.value="";r.isHexOnly=true;return r}t.blockName=function(){return"SimpleStringValueBlock"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.value=this.value;return t};return t}(q(W));var Ee=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t,Ce)||this;if("value"in t)r.fromString(t.value);return r}t.blockName=function(){return"SIMPLESTRING"};t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){this.valueBlock.value=String.fromCharCode.apply(null,new Uint8Array(e))};t.prototype.fromString=function(e){var t=e.length;this.valueBlock.valueHex=new ArrayBuffer(t);var r=new Uint8Array(this.valueBlock.valueHex);for(var n=0;n<t;n++)r[n]=e.charCodeAt(n);this.valueBlock.value=e};return t}(Y);var Ie=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=18;return r}t.blockName=function(){return"NumericString"};return t}(Ee);var Oe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=19;return r}t.blockName=function(){return"PrintableString"};return t}(Ee);var Le=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=20;return r}t.blockName=function(){return"TeletexString"};return t}(Ee);var De=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=21;return r}t.blockName=function(){return"VideotexString"};return t}(Ee);var He=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=22;return r}t.blockName=function(){return"IA5String"};return t}(Ee);var Re=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=25;return r}t.blockName=function(){return"GraphicString"};return t}(Ee);var Te=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=26;return r}t.blockName=function(){return"VisibleString"};return t}(Ee);var Ue=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=27;return r}t.blockName=function(){return"GeneralString"};return t}(Ee);var Pe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=29;return r}t.blockName=function(){return"CharacterString"};return t}(Ee);var je=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.year=0;r.month=0;r.day=0;r.hour=0;r.minute=0;r.second=0;if("value"in t){r.fromString(t.value);r.valueBlock.valueHex=new ArrayBuffer(t.value.length);var n=new Uint8Array(r.valueBlock.valueHex);for(var i=0;i<t.value.length;i++)n[i]=t.value.charCodeAt(i)}if("valueDate"in t){r.fromDate(t.valueDate);r.valueBlock.valueHex=r.toBuffer()}r.idBlock.tagClass=1;r.idBlock.tagNumber=23;return r}t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))};t.prototype.toBuffer=function(){var e=this.toString();var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t};t.prototype.fromDate=function(e){this.year=e.getUTCFullYear();this.month=e.getUTCMonth()+1;this.day=e.getUTCDate();this.hour=e.getUTCHours();this.minute=e.getUTCMinutes();this.second=e.getUTCSeconds()};t.prototype.toDate=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second))};t.prototype.fromString=function(e){var t=/(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})Z/gi;var r=t.exec(e);if(r===null){this.error="Wrong input string for convertion";return}var n=parseInt(r[1],10);if(n>=50)this.year=1900+n;else this.year=2e3+n;this.month=parseInt(r[2],10);this.day=parseInt(r[3],10);this.hour=parseInt(r[4],10);this.minute=parseInt(r[5],10);this.second=parseInt(r[6],10)};t.prototype.toString=function(){var e=new Array(7);e[0]=J(this.year<2e3?this.year-1900:this.year-2e3,2);e[1]=J(this.month,2);e[2]=J(this.day,2);e[3]=J(this.hour,2);e[4]=J(this.minute,2);e[5]=J(this.second,2);e[6]="Z";return e.join("")};t.blockName=function(){return"UTCTime"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.year=this.year;t.month=this.month;t.day=this.day;t.hour=this.hour;t.minute=this.minute;t.second=this.second;return t};return t}(Te);var Fe=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.year=0;r.month=0;r.day=0;r.hour=0;r.minute=0;r.second=0;r.millisecond=0;if("value"in t){r.fromString(t.value);r.valueBlock.valueHex=new ArrayBuffer(t.value.length);var n=new Uint8Array(r.valueBlock.valueHex);for(var i=0;i<t.value.length;i++)n[i]=t.value.charCodeAt(i)}if("valueDate"in t){r.fromDate(t.valueDate);r.valueBlock.valueHex=r.toBuffer()}r.idBlock.tagClass=1;r.idBlock.tagNumber=24;return r}t.prototype.fromBER=function(e,t,r){var n=this.valueBlock.fromBER(e,t,this.lenBlock.isIndefiniteForm===true?r:this.lenBlock.length);if(n===-1){this.error=this.valueBlock.error;return n}this.fromBuffer(this.valueBlock.valueHex);if(this.idBlock.error.length===0)this.blockLength+=this.idBlock.blockLength;if(this.lenBlock.error.length===0)this.blockLength+=this.lenBlock.blockLength;if(this.valueBlock.error.length===0)this.blockLength+=this.valueBlock.blockLength;return n};t.prototype.fromBuffer=function(e){this.fromString(String.fromCharCode.apply(null,new Uint8Array(e)))};t.prototype.toBuffer=function(){var e=this.toString();var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t};t.prototype.fromDate=function(e){this.year=e.getUTCFullYear();this.month=e.getUTCMonth()+1;this.day=e.getUTCDate();this.hour=e.getUTCHours();this.minute=e.getUTCMinutes();this.second=e.getUTCSeconds();this.millisecond=e.getUTCMilliseconds()};t.prototype.toDate=function(){return new Date(Date.UTC(this.year,this.month-1,this.day,this.hour,this.minute,this.second,this.millisecond))};t.prototype.fromString=function(e){var t=false;var r="";var n="";var i=0;var o;var a=0;var s=0;if(e[e.length-1]==="Z"){r=e.substr(0,e.length-1);t=true}else{var u=new Number(e[e.length-1]);if(isNaN(u.valueOf()))throw new Error("Wrong input string for convertion");r=e}if(t){if(r.indexOf("+")!==-1)throw new Error("Wrong input string for convertion");if(r.indexOf("-")!==-1)throw new Error("Wrong input string for convertion")}else{var l=1;var c=r.indexOf("+");var f="";if(c===-1){c=r.indexOf("-");l=-1}if(c!==-1){f=r.substr(c+1);r=r.substr(0,c);if(f.length!==2&&f.length!==4)throw new Error("Wrong input string for convertion");var u=new Number(f.substr(0,2));if(isNaN(u.valueOf()))throw new Error("Wrong input string for convertion");a=l*u;if(f.length===4){u=new Number(f.substr(2,2));if(isNaN(u.valueOf()))throw new Error("Wrong input string for convertion");s=l*u}}}var h=r.indexOf(".");if(h===-1)h=r.indexOf(",");if(h!==-1){var v=new Number("0"+r.substr(h));if(isNaN(v.valueOf()))throw new Error("Wrong input string for convertion");i=v.valueOf();n=r.substr(0,h)}else n=r;switch(true){case n.length===8:o=/(\d{4})(\d{2})(\d{2})/gi;if(h!==-1)throw new Error("Wrong input string for convertion");break;case n.length===10:o=/(\d{4})(\d{2})(\d{2})(\d{2})/gi;if(h!==-1){var p=60*i;this.minute=Math.floor(p);p=60*(p-this.minute);this.second=Math.floor(p);p=1e3*(p-this.second);this.millisecond=Math.floor(p)}break;case n.length===12:o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})/gi;if(h!==-1){var p=60*i;this.second=Math.floor(p);p=1e3*(p-this.second);this.millisecond=Math.floor(p)}break;case n.length===14:o=/(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})/gi;if(h!==-1){var p=1e3*i;this.millisecond=Math.floor(p)}break;default:throw new Error("Wrong input string for convertion")}var d=o.exec(n);if(d===null)throw new Error("Wrong input string for convertion");for(var g=1;g<d.length;g++){switch(g){case 1:this.year=parseInt(d[g],10);break;case 2:this.month=parseInt(d[g],10);break;case 3:this.day=parseInt(d[g],10);break;case 4:this.hour=parseInt(d[g],10)+a;break;case 5:this.minute=parseInt(d[g],10)+s;break;case 6:this.second=parseInt(d[g],10);break;default:throw new Error("Wrong input string for convertion")}}if(t===false){var y=new Date(this.year,this.month,this.day,this.hour,this.minute,this.second,this.millisecond);this.year=y.getUTCFullYear();this.month=y.getUTCMonth();this.day=y.getUTCDay();this.hour=y.getUTCHours();this.minute=y.getUTCMinutes();this.second=y.getUTCSeconds();this.millisecond=y.getUTCMilliseconds()}};t.prototype.toString=function(){var e=[];e.push(J(this.year,4));e.push(J(this.month,2));e.push(J(this.day,2));e.push(J(this.hour,2));e.push(J(this.minute,2));e.push(J(this.second,2));if(this.millisecond!==0){e.push(".");e.push(J(this.millisecond,3))}e.push("Z");return e.join("")};t.blockName=function(){return"GeneralizedTime"};t.prototype.toJSON=function(){var t={};try{t=e.prototype.toJSON.call(this)}catch(r){}t.year=this.year;t.month=this.month;t.day=this.day;t.hour=this.hour;t.minute=this.minute;t.second=this.second;t.millisecond=this.millisecond;return t};return t}(Te);var Ve=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=31;return r}t.blockName=function(){return"DATE"};return t}(ke);var Me=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=32;return r}t.blockName=function(){return"TimeOfDay"};return t}(ke);var Je=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=33;return r}t.blockName=function(){return"DateTime"};return t}(ke);var Ge=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=34;return r}t.blockName=function(){return"Duration"};return t}(ke);var ze=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;r.idBlock.tagClass=1;r.idBlock.tagNumber=14;return r}t.blockName=function(){return"TIME"};return t}(ke);var We=function(){function e(e){if(e===void 0){e={}}this.value=D(e,"value",[]);this.optional=D(e,"optional",false)}return e}();var qe=function(){function e(e){if(e===void 0){e={}}this.name=D(e,"name","");this.optional=D(e,"optional",false)}return e}();var $e=function(){function e(e){if(e===void 0){e={}}this.name=D(e,"name","");this.optional=D(e,"optional",false);this.value=D(e,"value",new qe);this.local=D(e,"local",false)}return e}();var Ze=function(){function e(e){if(e===void 0){e={}}this.data=D(e,"data",new ArrayBuffer(0))}e.prototype.fromBER=function(e,t,r){this.data=e.slice(t,r);return t+r};e.prototype.toBER=function(e){if(e===void 0){e=false}return this.data};return e}();function Ke(e,t,r){var n=t;function i(e,t){if(e instanceof t)return e;var r=new t;r.idBlock=e.idBlock;r.lenBlock=e.lenBlock;r.warnings=e.warnings;r.valueBeforeDecode=e.valueBeforeDecode.slice(0);return r}var o=new Y({},Object);var a=new W;if(R(a,e,t,r)===false){o.error=a.error;return{offset:-1,result:o}}var s=new Uint8Array(e,t,r);if(s.length===0){this.error="Zero buffer length";return{offset:-1,result:o}}var u=o.idBlock.fromBER(e,t,r);o.warnings.concat(o.idBlock.warnings);if(u===-1){o.error=o.idBlock.error;return{offset:-1,result:o}}t=u;r-=o.idBlock.blockLength;u=o.lenBlock.fromBER(e,t,r);o.warnings.concat(o.lenBlock.warnings);if(u===-1){o.error=o.lenBlock.error;return{offset:-1,result:o}}t=u;r-=o.lenBlock.blockLength;if(o.idBlock.isConstructed===false&&o.lenBlock.isIndefiniteForm===true){o.error="Indefinite length form used for primitive encoding form";return{offset:-1,result:o}}var l=Y;switch(o.idBlock.tagClass){case 1:if(o.idBlock.tagNumber>=37&&o.idBlock.isHexOnly===false){o.error="UNIVERSAL 37 and upper tags are reserved by ASN.1 standard";return{offset:-1,result:o}}switch(o.idBlock.tagNumber){case 0:if(o.idBlock.isConstructed===true&&o.lenBlock.length>0){o.error="Type [UNIVERSAL 0] is reserved";return{offset:-1,result:o}}l=ne;break;case 1:l=oe;break;case 2:l=pe;break;case 3:l=he;break;case 4:l=ce;break;case 5:l=ue;break;case 6:l=me;break;case 10:l=de;break;case 12:l=ke;break;case 13:l=Se;break;case 14:l=ze;break;case 15:o.error="[UNIVERSAL 15] is reserved by ASN.1 standard";return{offset:-1,result:o};case 16:l=ae;break;case 17:l=se;break;case 18:l=Ie;break;case 19:l=Oe;break;case 20:l=Le;break;case 21:l=De;break;case 22:l=He;break;case 23:l=je;break;case 24:l=Fe;break;case 25:l=Re;break;case 26:l=Te;break;case 27:l=Ue;break;case 28:l=Ne;break;case 29:l=Pe;break;case 30:l=Ae;break;case 31:l=Ve;break;case 32:l=Me;break;case 33:l=Je;break;case 34:l=Ge;break;default:{var c=void 0;if(o.idBlock.isConstructed===true)c=new te;else c=new X;c.idBlock=o.idBlock;c.lenBlock=o.lenBlock;c.warnings=o.warnings;o=c;u=o.fromBER(e,t,r)}}break;case 2:case 3:case 4:default:{if(o.idBlock.isConstructed===true)l=te;else l=X}}o=i(o,l);u=o.fromBER(e,t,o.lenBlock.isIndefiniteForm===true?r:o.lenBlock.length);o.valueBeforeDecode=e.slice(n,n+o.blockLength);return{offset:u,result:o}}function Ye(e){if(e.byteLength===0){var t=new Y({},Object);t.error="Input buffer has zero length";return{offset:-1,result:t}}return Ke(e,0,e.byteLength)}function Qe(e,t,r){if(r instanceof We){for(var n=0;n<r.value.length;n++){var i=Qe(e,t,r.value[n]);if(i.verified===true){return{verified:true,result:e}}}{var o={verified:false,result:{error:"Wrong values for Choice type"}};if(r.hasOwnProperty("name"))o.name=r.name;return o}}if(r instanceof qe){if(r.hasOwnProperty("name"))e[r.name]=t;return{verified:true,result:e}}if(e instanceof Object===false){return{verified:false,result:{error:"Wrong root object"}}}if(t instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 data"}}}if(r instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if("idBlock"in r===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if("fromBER"in r.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if("toBER"in r.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}var a=r.idBlock.toBER(false);if(a.byteLength===0){return{verified:false,result:{error:"Error encoding idBlock for ASN.1 schema"}}}var s=r.idBlock.fromBER(a,0,a.byteLength);if(s===-1){return{verified:false,result:{error:"Error decoding idBlock for ASN.1 schema"}}}if(r.idBlock.hasOwnProperty("tagClass")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(r.idBlock.tagClass!==t.idBlock.tagClass){return{verified:false,result:e}}if(r.idBlock.hasOwnProperty("tagNumber")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(r.idBlock.tagNumber!==t.idBlock.tagNumber){return{verified:false,result:e}}if(r.idBlock.hasOwnProperty("isConstructed")===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(r.idBlock.isConstructed!==t.idBlock.isConstructed){return{verified:false,result:e}}if("isHexOnly"in r.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}if(r.idBlock.isHexOnly!==t.idBlock.isHexOnly){return{verified:false,result:e}}if(r.idBlock.isHexOnly===true){if("valueHex"in r.idBlock===false){return{verified:false,result:{error:"Wrong ASN.1 schema"}}}var u=new Uint8Array(r.idBlock.valueHex);var l=new Uint8Array(t.idBlock.valueHex);if(u.length!==l.length){return{verified:false,result:e}}for(var c=0;c<u.length;c++){if(u[c]!==l[1]){return{verified:false,result:e}}}}if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!=="")e[r.name]=t}if(r.idBlock.isConstructed===true){var f=0;var i={verified:false};var h=r.valueBlock.value.length;if(h>0){if(r.valueBlock.value[0]instanceof $e)h=t.valueBlock.value.length}if(h===0){return{verified:true,result:e}}if(t.valueBlock.value.length===0&&r.valueBlock.value.length!==0){var v=true;for(var c=0;c<r.valueBlock.value.length;c++)v=v&&(r.valueBlock.value[c].optional||false);if(v===true){return{verified:true,result:e}}if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!=="")delete e[r.name]}e.error="Inconsistent object length";return{verified:false,result:e}}for(var c=0;c<h;c++){if(c-f>=t.valueBlock.value.length){if(r.valueBlock.value[c].optional===false){var o={verified:false,result:e};e.error="Inconsistent length between ASN.1 data and schema";if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!==""){delete e[r.name];o.name=r.name}}return o}}else{if(r.valueBlock.value[0]instanceof $e){i=Qe(e,t.valueBlock.value[c],r.valueBlock.value[0].value);if(i.verified===false){if(r.valueBlock.value[0].optional===true)f++;else{if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!=="")delete e[r.name]}return i}}if("name"in r.valueBlock.value[0]&&r.valueBlock.value[0].name.length>0){var p={};if("local"in r.valueBlock.value[0]&&r.valueBlock.value[0].local===true)p=t;else p=e;if(typeof p[r.valueBlock.value[0].name]==="undefined")p[r.valueBlock.value[0].name]=[];p[r.valueBlock.value[0].name].push(t.valueBlock.value[c])}}else{i=Qe(e,t.valueBlock.value[c-f],r.valueBlock.value[c]);if(i.verified===false){if(r.valueBlock.value[c].optional===true)f++;else{if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!=="")delete e[r.name]}return i}}}}}if(i.verified===false){var o={verified:false,result:e};if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!==""){delete e[r.name];o.name=r.name}}return o}return{verified:true,result:e}}if("primitiveSchema"in r&&"valueHex"in t.valueBlock){var d=Ye(t.valueBlock.valueHex);if(d.offset===-1){var o={verified:false,result:d.result};if(r.hasOwnProperty("name")){r.name=r.name.replace(/^\s+|\s+$/g,"");if(r.name!==""){delete e[r.name];o.name=r.name}}return o}return Qe(e,d.result,r.primitiveSchema)}return{verified:true,result:e}}function Xe(e,t){if(t instanceof Object===false){return{verified:false,result:{error:"Wrong ASN.1 schema type"}}}var r=Ye(e);if(r.offset===-1){return{verified:false,result:r.result}}return Qe(r.result,r.result,t)}function et(e){}var tt=Object.freeze({__proto__:null,HexBlock:q,ValueBlock:K,BaseBlock:Y,Primitive:X,Constructed:te,EndOfContent:ne,Boolean:oe,Sequence:ae,Set:se,Null:ue,OctetString:ce,BitString:he,Integer:pe,Enumerated:de,ObjectIdentifier:me,Utf8String:ke,RelativeObjectIdentifier:Se,BmpString:Ae,UniversalString:Ne,NumericString:Ie,PrintableString:Oe,TeletexString:Le,VideotexString:De,IA5String:He,GraphicString:Re,VisibleString:Te,GeneralString:Ue,CharacterString:Pe,UTCTime:je,GeneralizedTime:Fe,DATE:Ve,TimeOfDay:Me,DateTime:Je,Duration:Ge,TIME:ze,Choice:We,Any:qe,Repeated:$e,RawData:Ze,fromBER:Ye,compareSchema:Qe,verifySchema:Xe,fromJSON:et});var rt;(function(e){e[e["Sequence"]=0]="Sequence";e[e["Set"]=1]="Set";e[e["Choice"]=2]="Choice"})(rt||(rt={}));var nt;(function(e){e[e["Any"]=1]="Any";e[e["Boolean"]=2]="Boolean";e[e["OctetString"]=3]="OctetString";e[e["BitString"]=4]="BitString";e[e["Integer"]=5]="Integer";e[e["Enumerated"]=6]="Enumerated";e[e["ObjectIdentifier"]=7]="ObjectIdentifier";e[e["Utf8String"]=8]="Utf8String";e[e["BmpString"]=9]="BmpString";e[e["UniversalString"]=10]="UniversalString";e[e["NumericString"]=11]="NumericString";e[e["PrintableString"]=12]="PrintableString";e[e["TeletexString"]=13]="TeletexString";e[e["VideotexString"]=14]="VideotexString";e[e["IA5String"]=15]="IA5String";e[e["GraphicString"]=16]="GraphicString";e[e["VisibleString"]=17]="VisibleString";e[e["GeneralString"]=18]="GeneralString";e[e["CharacterString"]=19]="CharacterString";e[e["UTCTime"]=20]="UTCTime";e[e["GeneralizedTime"]=21]="GeneralizedTime";e[e["DATE"]=22]="DATE";e[e["TimeOfDay"]=23]="TimeOfDay";e[e["DateTime"]=24]="DateTime";e[e["Duration"]=25]="Duration";e[e["TIME"]=26]="TIME";e[e["Null"]=27]="Null"})(nt||(nt={}));var it={fromASN:function(e){return e instanceof ue?null:e.valueBeforeDecode},toASN:function(e){if(e===null){return new ue}var t=Ye(e);if(t.result.error){throw new Error(t.result.error)}return t.result}};var ot={fromASN:function(e){return e.valueBlock.valueHex.byteLength>4?e.valueBlock.toString():e.valueBlock.valueDec},toASN:function(e){return new pe({value:e})}};var at={fromASN:function(e){return e.valueBlock.valueDec},toASN:function(e){return new de({value:e})}};var st={fromASN:function(e){return e.valueBlock.valueHex},toASN:function(e){return new pe({valueHex:e})}};var ut={fromASN:function(e){return e.valueBlock.valueHex},toASN:function(e){return new he({valueHex:e})}};var lt={fromASN:function(e){return e.valueBlock.toString()},toASN:function(e){return new me({value:e})}};var ct={fromASN:function(e){return e.valueBlock.value},toASN:function(e){return new oe({value:e})}};var ft={fromASN:function(e){return e.valueBlock.valueHex},toASN:function(e){return new ce({valueHex:e})}};function ht(e){return{fromASN:function(e){return e.valueBlock.value},toASN:function(t){return new e({value:t})}}}var vt=ht(ke);var pt=ht(Ae);var dt=ht(Ne);var gt=ht(Ie);var yt=ht(Oe);var mt=ht(Le);var bt=ht(De);var kt=ht(He);var Bt=ht(Re);var wt=ht(Te);var St=ht(Ue);var _t=ht(Pe);var At={fromASN:function(e){return e.toDate()},toASN:function(e){return new je({valueDate:e})}};var xt={fromASN:function(e){return e.toDate()},toASN:function(e){return new Fe({valueDate:e})}};var Nt={fromASN:function(e){return null},toASN:function(e){return new ue}};function Ct(e){switch(e){case nt.Any:return it;case nt.BitString:return ut;case nt.BmpString:return pt;case nt.Boolean:return ct;case nt.CharacterString:return _t;case nt.Enumerated:return at;case nt.GeneralString:return St;case nt.GeneralizedTime:return xt;case nt.GraphicString:return Bt;case nt.IA5String:return kt;case nt.Integer:return ot;case nt.Null:return Nt;case nt.NumericString:return gt;case nt.ObjectIdentifier:return lt;case nt.OctetString:return ft;case nt.PrintableString:return yt;case nt.TeletexString:return mt;case nt.UTCTime:return At;case nt.UniversalString:return dt;case nt.Utf8String:return vt;case nt.VideotexString:return bt;case nt.VisibleString:return wt;default:return null}}var Et=function(){function e(e,t){if(t===void 0){t=0}this.unusedBits=0;this.value=new ArrayBuffer(0);if(e){if(typeof e==="number"){this.fromNumber(e)}else if(s.isBufferSource(e)){this.unusedBits=t;this.value=s.toArrayBuffer(e)}else{throw TypeError("Unsupported type of 'params' argument for BitString")}}}e.prototype.fromASN=function(e){if(!(e instanceof he)){throw new TypeError("Argument 'asn' is not instance of ASN.1 BitString")}this.unusedBits=e.valueBlock.unusedBits;this.value=e.valueBlock.valueHex;return this};e.prototype.toASN=function(){return new he({unusedBits:this.unusedBits,valueHex:this.value})};e.prototype.toSchema=function(e){return new he({name:e})};e.prototype.toNumber=function(){var e="";var t=new Uint8Array(this.value);for(var r=0,n=t;r<n.length;r++){var i=n[r];e+=i.toString(2).padStart(8,"0")}e=e.split("").reverse().join("");if(this.unusedBits){e=e.slice(this.unusedBits).padStart(this.unusedBits,"0")}return parseInt(e,2)};e.prototype.fromNumber=function(e){var t=e.toString(2);var r=t.length+7>>3;this.unusedBits=(r<<3)-t.length;var n=new Uint8Array(r);t=t.padStart(r<<3,"0").split("").reverse().join("");var i=0;while(i<r){n[i]=parseInt(t.slice(i<<3,(i<<3)+8),2);i++}this.value=n.buffer};return e}();var It=function(e){__extends(t,e);function t(t){var r=this;if(typeof t==="number"){r=e.call(this,t)||this}else{if(s.isBufferSource(t)){r=e.call(this,t.byteLength)||this;var n=new Uint8Array(r);n.set(s.toUint8Array(t))}else if(Array.isArray(t)){var i=new Uint8Array(t);r=e.call(this,i.length)||this;var o=new Uint8Array(r);o.set(i)}else{r=e.call(this,0)||this}}return r}t.prototype.fromASN=function(e){if(!(e instanceof ce)){throw new TypeError("Argument 'asn' is not instance of ASN.1 OctetString")}return new t(e.valueBlock.valueHex)};t.prototype.toASN=function(){return new ce({valueHex:this})};t.prototype.toSchema=function(e){return new ce({name:e})};return t}(ArrayBuffer);function Ot(e){if(e&&e.prototype){if(e.prototype.toASN&&e.prototype.fromASN){return true}else{return Ot(e.prototype)}}else{return!!(e&&e.toASN&&e.fromASN)}}function Lt(e){var t;if(e){var r=Object.getPrototypeOf(e);if(((t=r===null||r===void 0?void 0:r.prototype)===null||t===void 0?void 0:t.constructor)===Array){return true}return Lt(r)}return false}function Dt(e,t){if(!(e&&t)){return false}if(e.byteLength!==t.byteLength){return false}var r=new Uint8Array(e);var n=new Uint8Array(t);for(var i=0;i<e.byteLength;i++){if(r[i]!==n[i]){return false}}return true}var Ht=function(){function e(){this.items=new WeakMap}e.prototype.has=function(e){return this.items.has(e)};e.prototype.get=function(e){var t,r,n,i;var o=this.items.get(e);if(!o){throw new Error("Cannot get schema for '"+((i=(n=(r=(t=e)===null||t===void 0?void 0:t.prototype)===null||r===void 0?void 0:r.constructor)===null||n===void 0?void 0:n.name)!==null&&i!==void 0?i:e)+"' target")}return o};e.prototype.cache=function(e){var t=this.get(e);if(!t.schema){t.schema=this.create(e,true)}};e.prototype.createDefault=function(e){var t={type:rt.Sequence,items:{}};var r=this.findParentSchema(e);if(r){Object.assign(t,r);t.items=Object.assign({},t.items,r.items)}return t};e.prototype.create=function(e,t){var r=this.items.get(e)||this.createDefault(e);var n=[];for(var i in r.items){var o=r.items[i];var a=t?i:"";var s=void 0;if(typeof o.type==="number"){var u=nt[o.type];var l=tt[u];if(!l){throw new Error("Cannot get ASN1 class by name '"+u+"'")}s=new l({name:a})}else if(Ot(o.type)){var c=new o.type;s=c.toSchema(a)}else{s=new qe({name:a})}var f=!!o.optional||o.defaultValue!==undefined;if(o.repeated){s.name="";var h=o.repeated==="set"?se:ae;s=new h({name:"",value:[new $e({name:a,value:s})]})}if(o.context!==null&&o.context!==undefined){if(o.implicit){if(typeof o.type==="number"||Ot(o.type)){var h=o.repeated?te:X;n.push(new h({name:a,optional:f,idBlock:{tagClass:3,tagNumber:o.context}}))}else{this.cache(o.type);var v=!!o.repeated;var p=!v?this.get(o.type).schema:s;p=p.valueBlock?p.valueBlock.value:p.value;n.push(new te({name:!v?a:"",optional:f,idBlock:{tagClass:3,tagNumber:o.context},value:p}))}}else{n.push(new te({optional:f,idBlock:{tagClass:3,tagNumber:o.context},value:[s]}))}}else{s.optional=f;n.push(s)}}switch(r.type){case rt.Sequence:return new ae({value:n,name:""});case rt.Set:return new se({value:n,name:""});case rt.Choice:return new We({value:n,name:""});default:throw new Error("Unsupported ASN1 type in use")}};e.prototype.set=function(e,t){this.items.set(e,t);return this};e.prototype.findParentSchema=function(e){var t=e.__proto__;if(t){var r=this.items.get(t);return r||this.findParentSchema(t)}return null};return e}();var Rt=new Ht;var Tt=function(e){return function(t){var r;if(!Rt.has(t)){r=Rt.createDefault(t);Rt.set(t,r)}else{r=Rt.get(t)}Object.assign(r,e)}};var Ut=function(e){return function(t,r){var n;if(!Rt.has(t.constructor)){n=Rt.createDefault(t.constructor);Rt.set(t.constructor,n)}else{n=Rt.get(t.constructor)}var i=Object.assign({},e);if(typeof i.type==="number"&&!i.converter){var o=Ct(e.type);if(!o){throw new Error("Cannot get default converter for property '"+r+"' of "+t.constructor.name)}i.converter=o}n.items[r]=i}};var Pt=function(e){__extends(t,e);function t(){var t=e.apply(this,arguments)||this;t.schemas=[];return t}return t}(Error);var jt=function(){function e(){}e.parse=function(e,t){var r;if(e instanceof ArrayBuffer){r=e}else if(typeof Buffer!==undefined&&Buffer.isBuffer(e)){r=new Uint8Array(e).buffer}else if(ArrayBuffer.isView(e)){r=e.buffer}else{throw new TypeError("Wrong type of 'data' argument")}var n=Ye(r);if(n.result.error){throw new Error(n.result.error)}var i=this.fromASN(n.result,t);return i};e.fromASN=function(e,t){var r=this;var n;try{if(Ot(t)){var i=new t;return i.fromASN(e)}var o=Rt.get(t);Rt.cache(t);var a=o.schema;if(e.constructor===te&&o.type!==rt.Choice){a=new te({idBlock:{tagClass:3,tagNumber:e.idBlock.tagNumber},value:o.schema.valueBlock.value});for(var s in o.items){delete e[s]}}var u=Qe(e,e,a);if(!u.verified){throw new Pt("Data does not match to "+t.name+" ASN1 schema. "+u.result.error)}var l=new t;if(Lt(t)){if(typeof o.itemType==="number"){var c=Ct(o.itemType);if(!c){throw new Error("Cannot get default converter for array item of "+t.name+" ASN1 schema")}return t.from(e.valueBlock.value,(function(e){return c.fromASN(e)}))}else{return t.from(e.valueBlock.value,(function(e){return r.fromASN(e,o.itemType)}))}}var f=function(t){if(!e[t]){return"continue"}var i=o.items[t];if(typeof i.type==="number"||Ot(i.type)){var a=(n=i.converter)!==null&&n!==void 0?n:Ot(i.type)?new i.type:null;if(!a){throw new Error("Converter is empty")}if(i.repeated){if(i.implicit){var s=i.repeated==="sequence"?ae:se;var u=new s;u.valueBlock=e[t].valueBlock;var c=Ye(u.toBER(false)).result.valueBlock.value;l[t]=Array.from(c,(function(e){return a.fromASN(e)}))}else{l[t]=Array.from(e[t],(function(e){return a.fromASN(e)}))}}else{var c=e[t];if(i.implicit){var u=void 0;if(Ot(i.type)){u=(new i.type).toSchema("")}else{var f=nt[i.type];var v=tt[f];if(!v){throw new Error("Cannot get '"+f+"' class from asn1js module")}u=new v}u.valueBlock=c.valueBlock;c=Ye(u.toBER(false)).result}l[t]=a.fromASN(c)}}else{if(i.repeated){l[t]=Array.from(e[t],(function(e){return r.fromASN(e,i.type)}))}else{l[t]=h.fromASN(e[t],i.type)}}};var h=this;for(var s in o.items){f(s)}return l}catch(v){if(v instanceof Pt){v.schemas.push(t.name)}throw v}};return e}();var Ft=function(){function e(){}e.serialize=function(e){if(e instanceof Y){return e.toBER(false)}return this.toASN(e).toBER(false)};e.toASN=function(t){var r=this;if(t&&Ot(t.constructor)){return t.toASN()}var n=t.constructor;var i=Rt.get(n);Rt.cache(n);var o=[];if(i.itemType){if(typeof i.itemType==="number"){var a=Ct(i.itemType);if(!a){throw new Error("Cannot get default converter for array item of "+n.name+" ASN1 schema")}o=t.map((function(e){return a.toASN(e)}))}else{o=t.map((function(e){return r.toAsnItem({type:i.itemType},"[]",n,e)}))}}else{for(var s in i.items){var u=i.items[s];var l=t[s];if(l===undefined||u.defaultValue===l||typeof u.defaultValue==="object"&&typeof l==="object"&&Dt(this.serialize(u.defaultValue),this.serialize(l))){continue}var c=e.toAsnItem(u,s,n,l);if(typeof u.context==="number"){if(u.implicit){if(!u.repeated&&(typeof u.type==="number"||Ot(u.type))){var f={};f.valueHex=c.valueBlock.toBER();o.push(new X(Object.assign({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context}},f)))}else{o.push(new te({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context},value:c.valueBlock.value}))}}else{o.push(new te({optional:u.optional,idBlock:{tagClass:3,tagNumber:u.context},value:[c]}))}}else if(u.repeated){o=o.concat(c)}else{o.push(c)}}}var h;switch(i.type){case rt.Sequence:h=new ae({value:o});break;case rt.Set:h=new se({value:o});break;case rt.Choice:if(!o[0]){throw new Error("Schema '"+n.name+"' has wrong data. Choice cannot be empty.")}h=o[0];break}return h};e.toAsnItem=function(e,t,r,n){var i=this;var o;if(typeof e.type==="number"){var a=e.converter;if(!a){throw new Error("Property '"+t+"' doesn't have converter for type "+nt[e.type]+" in schema '"+r.name+"'")}if(e.repeated){var s=Array.from(n,(function(e){return a.toASN(e)}));var u=e.repeated==="sequence"?ae:se;o=new u({value:s})}else{o=a.toASN(n)}}else{if(e.repeated){var s=Array.from(n,(function(e){return i.toASN(e)}));var u=e.repeated==="sequence"?ae:se;o=new u({value:s})}else{o=this.toASN(n)}}return o};return e}();var Vt=function(e){__extends(t,e);function t(t){if(t===void 0){t=[]}var r=this;if(typeof t==="number"){r=e.call(this,t)||this}else{r=e.call(this)||this;for(var n=0,i=t;n<i.length;n++){var o=i[n];r.push(o)}}return r}return t}(Array);var Mt=function(){function e(){}e.serialize=function(e){return Ft.serialize(e)};e.parse=function(e,t){return jt.parse(e,t)};return e}();var Jt=u((function(e){(function(){var t,r,n,i,o,a,s,u,l;r={};u=this;if(e!==null&&e.exports){e.exports=r}else{u["ipaddr"]=r}s=function(e,t,r,n){var i,o;if(e.length!==t.length){throw new Error("ipaddr: cannot match CIDR for objects with different lengths")}i=0;while(n>0){o=r-n;if(o<0){o=0}if(e[i]>>o!==t[i]>>o){return false}n-=r;i+=1}return true};r.subnetMatch=function(e,t,r){var n,i,o,a,s;if(r==null){r="unicast"}for(o in t){a=t[o];if(a[0]&&!(a[0]instanceof Array)){a=[a]}for(n=0,i=a.length;n<i;n++){s=a[n];if(e.kind()===s[0].kind()){if(e.match.apply(e,s)){return o}}}}return r};r.IPv4=function(){function e(e){var t,r,n;if(e.length!==4){throw new Error("ipaddr: ipv4 octet count should be 4")}for(t=0,r=e.length;t<r;t++){n=e[t];if(!(0<=n&&n<=255)){throw new Error("ipaddr: ipv4 octet should fit in 8 bits")}}this.octets=e}e.prototype.kind=function(){return"ipv4"};e.prototype.toString=function(){return this.octets.join(".")};e.prototype.toNormalizedString=function(){return this.toString()};e.prototype.toByteArray=function(){return this.octets.slice(0)};e.prototype.match=function(e,t){var r;if(t===void 0){r=e,e=r[0],t=r[1]}if(e.kind()!=="ipv4"){throw new Error("ipaddr: cannot match ipv4 address with non-ipv4 one")}return s(this.octets,e.octets,8,t)};e.prototype.SpecialRanges={unspecified:[[new e([0,0,0,0]),8]],broadcast:[[new e([255,255,255,255]),32]],multicast:[[new e([224,0,0,0]),4]],linkLocal:[[new e([169,254,0,0]),16]],loopback:[[new e([127,0,0,0]),8]],carrierGradeNat:[[new e([100,64,0,0]),10]],private:[[new e([10,0,0,0]),8],[new e([172,16,0,0]),12],[new e([192,168,0,0]),16]],reserved:[[new e([192,0,0,0]),24],[new e([192,0,2,0]),24],[new e([192,88,99,0]),24],[new e([198,51,100,0]),24],[new e([203,0,113,0]),24],[new e([240,0,0,0]),4]]};e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)};e.prototype.toIPv4MappedAddress=function(){return r.IPv6.parse("::ffff:"+this.toString())};e.prototype.prefixLengthFromSubnetMask=function(){var e,t,r,n,i,o,a;a={0:8,128:7,192:6,224:5,240:4,248:3,252:2,254:1,255:0};e=0;i=false;for(t=r=3;r>=0;t=r+=-1){n=this.octets[t];if(n in a){o=a[n];if(i&&o!==0){return null}if(o!==8){i=true}e+=o}else{return null}}return 32-e};return e}();n="(0?\\d+|0x[a-f0-9]+)";i={fourOctet:new RegExp("^"+n+"\\."+n+"\\."+n+"\\."+n+"$","i"),longValue:new RegExp("^"+n+"$","i")};r.IPv4.parser=function(e){var t,r,n,o,a;r=function(e){if(e[0]==="0"&&e[1]!=="x"){return parseInt(e,8)}else{return parseInt(e)}};if(t=e.match(i.fourOctet)){return function(){var e,i,o,a;o=t.slice(1,6);a=[];for(e=0,i=o.length;e<i;e++){n=o[e];a.push(r(n))}return a}()}else if(t=e.match(i.longValue)){a=r(t[1]);if(a>4294967295||a<0){throw new Error("ipaddr: address outside defined range")}return function(){var e,t;t=[];for(o=e=0;e<=24;o=e+=8){t.push(a>>o&255)}return t}().reverse()}else{return null}};r.IPv6=function(){function e(e,t){var r,n,i,o,a,s;if(e.length===16){this.parts=[];for(r=n=0;n<=14;r=n+=2){this.parts.push(e[r]<<8|e[r+1])}}else if(e.length===8){this.parts=e}else{throw new Error("ipaddr: ipv6 part count should be 8 or 16")}s=this.parts;for(i=0,o=s.length;i<o;i++){a=s[i];if(!(0<=a&&a<=65535)){throw new Error("ipaddr: ipv6 part should fit in 16 bits")}}if(t){this.zoneId=t}}e.prototype.kind=function(){return"ipv6"};e.prototype.toString=function(){return this.toNormalizedString().replace(/((^|:)(0(:|$))+)/,"::")};e.prototype.toRFC5952String=function(){var e,t,r,n,i;n=/((^|:)(0(:|$)){2,})/g;i=this.toNormalizedString();e=0;t=-1;while(r=n.exec(i)){if(r[0].length>t){e=r.index;t=r[0].length}}if(t<0){return i}return i.substring(0,e)+"::"+i.substring(e+t)};e.prototype.toByteArray=function(){var e,t,r,n,i;e=[];i=this.parts;for(t=0,r=i.length;t<r;t++){n=i[t];e.push(n>>8);e.push(n&255)}return e};e.prototype.toNormalizedString=function(){var e,t,r;e=function(){var e,r,n,i;n=this.parts;i=[];for(e=0,r=n.length;e<r;e++){t=n[e];i.push(t.toString(16))}return i}.call(this).join(":");r="";if(this.zoneId){r="%"+this.zoneId}return e+r};e.prototype.toFixedLengthString=function(){var e,t,r;e=function(){var e,r,n,i;n=this.parts;i=[];for(e=0,r=n.length;e<r;e++){t=n[e];i.push(t.toString(16).padStart(4,"0"))}return i}.call(this).join(":");r="";if(this.zoneId){r="%"+this.zoneId}return e+r};e.prototype.match=function(e,t){var r;if(t===void 0){r=e,e=r[0],t=r[1]}if(e.kind()!=="ipv6"){throw new Error("ipaddr: cannot match ipv6 address with non-ipv6 one")}return s(this.parts,e.parts,16,t)};e.prototype.SpecialRanges={unspecified:[new e([0,0,0,0,0,0,0,0]),128],linkLocal:[new e([65152,0,0,0,0,0,0,0]),10],multicast:[new e([65280,0,0,0,0,0,0,0]),8],loopback:[new e([0,0,0,0,0,0,0,1]),128],uniqueLocal:[new e([64512,0,0,0,0,0,0,0]),7],ipv4Mapped:[new e([0,0,0,0,0,65535,0,0]),96],rfc6145:[new e([0,0,0,0,65535,0,0,0]),96],rfc6052:[new e([100,65435,0,0,0,0,0,0]),96],"6to4":[new e([8194,0,0,0,0,0,0,0]),16],teredo:[new e([8193,0,0,0,0,0,0,0]),32],reserved:[[new e([8193,3512,0,0,0,0,0,0]),32]]};e.prototype.range=function(){return r.subnetMatch(this,this.SpecialRanges)};e.prototype.isIPv4MappedAddress=function(){return this.range()==="ipv4Mapped"};e.prototype.toIPv4Address=function(){var e,t,n;if(!this.isIPv4MappedAddress()){throw new Error("ipaddr: trying to convert a generic ipv6 address to ipv4")}n=this.parts.slice(-2),e=n[0],t=n[1];return new r.IPv4([e>>8,e&255,t>>8,t&255])};e.prototype.prefixLengthFromSubnetMask=function(){var e,t,r,n,i,o,a;a={0:16,32768:15,49152:14,57344:13,61440:12,63488:11,64512:10,65024:9,65280:8,65408:7,65472:6,65504:5,65520:4,65528:3,65532:2,65534:1,65535:0};e=0;i=false;for(t=r=7;r>=0;t=r+=-1){n=this.parts[t];if(n in a){o=a[n];if(i&&o!==0){return null}if(o!==16){i=true}e+=o}else{return null}}return 128-e};return e}();o="(?:[0-9a-f]+::?)+";l="%[0-9a-z]{1,}";a={zoneIndex:new RegExp(l,"i"),native:new RegExp("^(::)?("+o+")?([0-9a-f]+)?(::)?("+l+")?$","i"),transitional:new RegExp("^((?:"+o+")|(?:::)(?:"+o+")?)"+(n+"\\."+n+"\\."+n+"\\."+n)+("("+l+")?$"),"i")};t=function(e,t){var r,n,i,o,s,u;if(e.indexOf("::")!==e.lastIndexOf("::")){return null}u=(e.match(a["zoneIndex"])||[])[0];if(u){u=u.substring(1);e=e.replace(/%.+$/,"")}r=0;n=-1;while((n=e.indexOf(":",n+1))>=0){r++}if(e.substr(0,2)==="::"){r--}if(e.substr(-2,2)==="::"){r--}if(r>t){return null}s=t-r;o=":";while(s--){o+="0:"}e=e.replace("::",o);if(e[0]===":"){e=e.slice(1)}if(e[e.length-1]===":"){e=e.slice(0,-1)}t=function(){var t,r,n,o;n=e.split(":");o=[];for(t=0,r=n.length;t<r;t++){i=n[t];o.push(parseInt(i,16))}return o}();return{parts:t,zoneId:u}};r.IPv6.parser=function(e){var r,n,i,o,s,u,l;if(a["native"].test(e)){return t(e,8)}else if(o=e.match(a["transitional"])){l=o[6]||"";r=t(o[1].slice(0,-1)+l,6);if(r.parts){u=[parseInt(o[2]),parseInt(o[3]),parseInt(o[4]),parseInt(o[5])];for(n=0,i=u.length;n<i;n++){s=u[n];if(!(0<=s&&s<=255)){return null}}r.parts.push(u[0]<<8|u[1]);r.parts.push(u[2]<<8|u[3]);return{parts:r.parts,zoneId:r.zoneId}}}return null};r.IPv4.isIPv4=r.IPv6.isIPv6=function(e){return this.parser(e)!==null};r.IPv4.isValid=function(e){try{new this(this.parser(e));return true}catch(t){return false}};r.IPv4.isValidFourPartDecimal=function(e){if(r.IPv4.isValid(e)&&e.match(/^(0|[1-9]\d*)(\.(0|[1-9]\d*)){3}$/)){return true}else{return false}};r.IPv6.isValid=function(e){var t;if(typeof e==="string"&&e.indexOf(":")===-1){return false}try{t=this.parser(e);new this(t.parts,t.zoneId);return true}catch(r){return false}};r.IPv4.parse=function(e){var t;t=this.parser(e);if(t===null){throw new Error("ipaddr: string is not formatted like ip address")}return new this(t)};r.IPv6.parse=function(e){var t;t=this.parser(e);if(t.parts===null){throw new Error("ipaddr: string is not formatted like ip address")}return new this(t.parts,t.zoneId)};r.IPv4.parseCIDR=function(e){var t,r,n;if(r=e.match(/^(.+)\/(\d+)$/)){t=parseInt(r[2]);if(t>=0&&t<=32){n=[this.parse(r[1]),t];Object.defineProperty(n,"toString",{value:function(){return this.join("/")}});return n}}throw new Error("ipaddr: string is not formatted like an IPv4 CIDR range")};r.IPv4.subnetMaskFromPrefixLength=function(e){var t,r,n;e=parseInt(e);if(e<0||e>32){throw new Error("ipaddr: invalid IPv4 prefix length")}n=[0,0,0,0];r=0;t=Math.floor(e/8);while(r<t){n[r]=255;r++}if(t<4){n[t]=Math.pow(2,e%8)-1<<8-e%8}return new this(n)};r.IPv4.broadcastAddressFromCIDR=function(e){var t,r,n,i,o;try{t=this.parseCIDR(e);n=t[0].toByteArray();o=this.subnetMaskFromPrefixLength(t[1]).toByteArray();i=[];r=0;while(r<4){i.push(parseInt(n[r],10)|parseInt(o[r],10)^255);r++}return new this(i)}catch(a){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};r.IPv4.networkAddressFromCIDR=function(e){var t,r,n,i,o;try{t=this.parseCIDR(e);n=t[0].toByteArray();o=this.subnetMaskFromPrefixLength(t[1]).toByteArray();i=[];r=0;while(r<4){i.push(parseInt(n[r],10)&parseInt(o[r],10));r++}return new this(i)}catch(a){throw new Error("ipaddr: the address does not have IPv4 CIDR format")}};r.IPv6.parseCIDR=function(e){var t,r,n;if(r=e.match(/^(.+)\/(\d+)$/)){t=parseInt(r[2]);if(t>=0&&t<=128){n=[this.parse(r[1]),t];Object.defineProperty(n,"toString",{value:function(){return this.join("/")}});return n}}throw new Error("ipaddr: string is not formatted like an IPv6 CIDR range")};r.isValid=function(e){return r.IPv6.isValid(e)||r.IPv4.isValid(e)};r.parse=function(e){if(r.IPv6.isValid(e)){return r.IPv6.parse(e)}else if(r.IPv4.isValid(e)){return r.IPv4.parse(e)}else{throw new Error("ipaddr: the address has neither IPv6 nor IPv4 format")}};r.parseCIDR=function(e){try{return r.IPv6.parseCIDR(e)}catch(t){try{return r.IPv4.parseCIDR(e)}catch(t){throw new Error("ipaddr: the address has neither IPv6 nor IPv4 CIDR format")}}};r.fromByteArray=function(e){var t;t=e.length;if(t===4){return new r.IPv4(e)}else if(t===16){return new r.IPv6(e)}else{throw new Error("ipaddr: the binary input is neither an IPv6 nor IPv4 address")}};r.process=function(e){var t;t=this.parse(e);if(t.kind()==="ipv6"&&t.isIPv4MappedAddress()){return t.toIPv4Address()}else{return t}}}).call(l)}));var Gt=Object.freeze({__proto__:null,default:Jt,__moduleExports:Jt});var zt=function(){function e(){}e.decodeIP=function(e){if(e.length===64&&parseInt(e,16)===0){return"::/0"}if(e.length!==16){return e}var t=parseInt(e.slice(8),16).toString(2).split("").reduce((function(e,t){return e+ +t}),0);var r=e.slice(0,8).replace(/(.{2})/g,(function(e){return parseInt(e,16)+"."}));r=r.slice(0,-1);return r+"/"+t};e.toString=function(e){if(e.byteLength===4||e.byteLength===16){var t=new Uint8Array(e);var r=undefined(Array.from(t));return r.toString()}return this.decodeIP(c.ToHex(e))};e.fromString=function(e){var t=undefined(e);return new Uint8Array(t.toByteArray()).buffer};return e}();var Wt=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}e.prototype.toString=function(){return this.bmpString||this.printableString||this.teletexString||this.universalString||this.utf8String||""};return e}();L([Ut({type:nt.TeletexString})],Wt.prototype,"teletexString",void 0);L([Ut({type:nt.PrintableString})],Wt.prototype,"printableString",void 0);L([Ut({type:nt.UniversalString})],Wt.prototype,"universalString",void 0);L([Ut({type:nt.Utf8String})],Wt.prototype,"utf8String",void 0);L([Ut({type:nt.BmpString})],Wt.prototype,"bmpString",void 0);Wt=L([Tt({type:rt.Choice})],Wt);var qt=function(e){__extends(t,e);function t(t){if(t===void 0){t={}}var r=e.call(this,t)||this;Object.assign(r,t);return r}t.prototype.toString=function(){return this.ia5String||(this.anyValue?c.ToHex(this.anyValue):e.prototype.toString.call(this))};return t}(Wt);L([Ut({type:nt.IA5String})],qt.prototype,"ia5String",void 0);L([Ut({type:nt.Any})],qt.prototype,"anyValue",void 0);qt=L([Tt({type:rt.Choice})],qt);var $t=function(){function e(e){if(e===void 0){e={}}this.type="";this.value=new qt;Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],$t.prototype,"type",void 0);L([Ut({type:qt})],$t.prototype,"value",void 0);var Zt=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Zt=L([Tt({type:rt.Set,itemType:$t})],Zt);var Kt=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Kt=L([Tt({type:rt.Sequence,itemType:Zt})],Kt);var Yt=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Kt);Yt=L([Tt({type:rt.Sequence})],Yt);var Qt={fromASN:function(e){return zt.toString(ft.fromASN(e))},toASN:function(e){return ft.toASN(zt.fromString(e))}};var Xt=function(){function e(e){if(e===void 0){e={}}this.typeId="";this.value=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],Xt.prototype,"typeId",void 0);L([Ut({type:nt.Any,context:0})],Xt.prototype,"value",void 0);var er=function(){function e(e){if(e===void 0){e={}}this.partyName=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:Wt,optional:true,context:0,implicit:true})],er.prototype,"nameAssigner",void 0);L([Ut({type:Wt,context:1,implicit:true})],er.prototype,"partyName",void 0);var tr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:Xt,context:0,implicit:true})],tr.prototype,"otherName",void 0);L([Ut({type:nt.IA5String,context:1,implicit:true})],tr.prototype,"rfc822Name",void 0);L([Ut({type:nt.IA5String,context:2,implicit:true})],tr.prototype,"dNSName",void 0);L([Ut({type:nt.Any,context:3,implicit:true})],tr.prototype,"x400Address",void 0);L([Ut({type:Yt,context:4,implicit:false})],tr.prototype,"directoryName",void 0);L([Ut({type:er,context:5})],tr.prototype,"ediPartyName",void 0);L([Ut({type:nt.IA5String,context:6,implicit:true})],tr.prototype,"uniformResourceIdentifier",void 0);L([Ut({type:nt.OctetString,context:7,implicit:true,converter:Qt})],tr.prototype,"iPAddress",void 0);L([Ut({type:nt.ObjectIdentifier,context:8,implicit:true})],tr.prototype,"registeredID",void 0);tr=L([Tt({type:rt.Choice})],tr);var rr="2.5.29";var nr=function(){function e(e){if(e===void 0){e={}}this.accessMethod="";this.accessLocation=new tr;Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],nr.prototype,"accessMethod",void 0);L([Ut({type:tr})],nr.prototype,"accessLocation",void 0);var ir=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);ir=L([Tt({type:rt.Sequence,itemType:nr})],ir);var or=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(It);var ar=function(){function e(e){if(e===void 0){e={}}if(e){Object.assign(this,e)}}return e}();L([Ut({type:or,context:0,optional:true,implicit:true})],ar.prototype,"keyIdentifier",void 0);L([Ut({type:tr,context:1,optional:true,implicit:true,repeated:"sequence"})],ar.prototype,"authorityCertIssuer",void 0);L([Ut({type:nt.Integer,context:2,optional:true,implicit:true,converter:st})],ar.prototype,"authorityCertSerialNumber",void 0);var sr=function(){function e(e){if(e===void 0){e={}}this.cA=false;Object.assign(this,e)}return e}();L([Ut({type:nt.Boolean,defaultValue:false})],sr.prototype,"cA",void 0);L([Ut({type:nt.Integer,optional:true})],sr.prototype,"pathLenConstraint",void 0);var ur=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);ur=L([Tt({type:rt.Sequence,itemType:tr})],ur);var lr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ur);lr=L([Tt({type:rt.Sequence})],lr);var cr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:nt.IA5String})],cr.prototype,"ia5String",void 0);L([Ut({type:nt.VisibleString})],cr.prototype,"visibleString",void 0);L([Ut({type:nt.BmpString})],cr.prototype,"bmpString",void 0);L([Ut({type:nt.Utf8String})],cr.prototype,"utf8String",void 0);cr=L([Tt({type:rt.Choice})],cr);var fr=function(){function e(e){if(e===void 0){e={}}this.organization=new cr;this.noticeNumbers=[];Object.assign(this,e)}return e}();L([Ut({type:cr})],fr.prototype,"organization",void 0);L([Ut({type:nt.Integer,repeated:"sequence"})],fr.prototype,"noticeNumbers",void 0);var hr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:fr,optional:true})],hr.prototype,"noticeRef",void 0);L([Ut({type:cr,optional:true})],hr.prototype,"explicitText",void 0);var vr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:nt.IA5String})],vr.prototype,"cPSuri",void 0);L([Ut({type:hr})],vr.prototype,"userNotice",void 0);vr=L([Tt({type:rt.Choice})],vr);var pr=function(){function e(e){if(e===void 0){e={}}this.policyQualifierId="";this.qualifier=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],pr.prototype,"policyQualifierId",void 0);L([Ut({type:nt.Any})],pr.prototype,"qualifier",void 0);var dr=function(){function e(e){if(e===void 0){e={}}this.policyIdentifier="";Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],dr.prototype,"policyIdentifier",void 0);L([Ut({type:pr,repeated:"sequence",optional:true})],dr.prototype,"policyQualifiers",void 0);var gr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);gr=L([Tt({type:rt.Sequence,itemType:dr})],gr);var yr;(function(e){e[e["unused"]=1]="unused";e[e["keyCompromise"]=2]="keyCompromise";e[e["cACompromise"]=4]="cACompromise";e[e["affiliationChanged"]=8]="affiliationChanged";e[e["superseded"]=16]="superseded";e[e["cessationOfOperation"]=32]="cessationOfOperation";e[e["certificateHold"]=64]="certificateHold";e[e["privilegeWithdrawn"]=128]="privilegeWithdrawn";e[e["aACompromise"]=256]="aACompromise"})(yr||(yr={}));var mr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.toJSON=function(){var e=[];var t=this.toNumber();if(t&yr.aACompromise){e.push("aACompromise")}if(t&yr.affiliationChanged){e.push("affiliationChanged")}if(t&yr.cACompromise){e.push("cACompromise")}if(t&yr.certificateHold){e.push("certificateHold")}if(t&yr.cessationOfOperation){e.push("cessationOfOperation")}if(t&yr.keyCompromise){e.push("keyCompromise")}if(t&yr.privilegeWithdrawn){e.push("privilegeWithdrawn")}if(t&yr.superseded){e.push("superseded")}if(t&yr.unused){e.push("unused")}return e};t.prototype.toString=function(){return"["+this.toJSON().join(", ")+"]"};return t}(Et);var br=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:tr,context:0,repeated:"sequence",implicit:true})],br.prototype,"fullName",void 0);L([Ut({type:Zt,context:1,implicit:true})],br.prototype,"nameRelativeToCRLIssuer",void 0);br=L([Tt({type:rt.Choice})],br);var kr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:br,context:0,optional:true})],kr.prototype,"distributionPoint",void 0);L([Ut({type:mr,context:1,optional:true,implicit:true})],kr.prototype,"reasons",void 0);L([Ut({type:tr,context:2,optional:true,repeated:"sequence",implicit:true})],kr.prototype,"cRLIssuer",void 0);var Br=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Br=L([Tt({type:rt.Sequence,itemType:kr})],Br);var wr;(function(e){e[e["unspecified"]=0]="unspecified";e[e["keyCompromise"]=1]="keyCompromise";e[e["cACompromise"]=2]="cACompromise";e[e["affiliationChanged"]=3]="affiliationChanged";e[e["superseded"]=4]="superseded";e[e["cessationOfOperation"]=5]="cessationOfOperation";e[e["certificateHold"]=6]="certificateHold";e[e["removeFromCRL"]=8]="removeFromCRL";e[e["privilegeWithdrawn"]=9]="privilegeWithdrawn";e[e["aACompromise"]=10]="aACompromise"})(wr||(wr={}));var Sr=function(){function e(e){if(e===void 0){e=wr.unspecified}this.reason=wr.unspecified;this.reason=e}return e}();L([Ut({type:nt.Enumerated})],Sr.prototype,"reason",void 0);Sr=L([Tt({type:rt.Choice})],Sr);var _r=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);_r=L([Tt({type:rt.Sequence,itemType:nt.ObjectIdentifier})],_r);var Ar=function(){function e(e){if(e===void 0){e=new ArrayBuffer(0)}this.value=e}return e}();L([Ut({type:nt.Integer,converter:st})],Ar.prototype,"value",void 0);Ar=L([Tt({type:rt.Choice})],Ar);var xr=function(){function e(e){this.value=new Date;if(e){this.value=e}}return e}();L([Ut({type:nt.GeneralizedTime})],xr.prototype,"value",void 0);xr=L([Tt({type:rt.Choice})],xr);var Nr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ur);Nr=L([Tt({type:rt.Sequence})],Nr);var Cr=rr+".15";var Er;(function(e){e[e["digitalSignature"]=1]="digitalSignature";e[e["nonRepudiation"]=2]="nonRepudiation";e[e["keyEncipherment"]=4]="keyEncipherment";e[e["dataEncipherment"]=8]="dataEncipherment";e[e["keyAgreement"]=16]="keyAgreement";e[e["keyCertSign"]=32]="keyCertSign";e[e["cRLSign"]=64]="cRLSign";e[e["encipherOnly"]=128]="encipherOnly";e[e["decipherOnly"]=256]="decipherOnly"})(Er||(Er={}));var Ir=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.toJSON=function(){var e=this.toNumber();var t=[];if(e&Er.cRLSign){t.push("crlSign")}if(e&Er.dataEncipherment){t.push("dataEncipherment")}if(e&Er.decipherOnly){t.push("decipherOnly")}if(e&Er.digitalSignature){t.push("digitalSignature")}if(e&Er.encipherOnly){t.push("encipherOnly")}if(e&Er.keyAgreement){t.push("keyAgreement")}if(e&Er.keyCertSign){t.push("keyCertSign")}if(e&Er.keyEncipherment){t.push("keyEncipherment")}if(e&Er.nonRepudiation){t.push("nonRepudiation")}return t};t.prototype.toString=function(){return"["+this.toJSON().join(", ")+"]"};return t}(Et);var Or=function(){function e(e){if(e===void 0){e={}}this.base=new tr;this.minimum=0;Object.assign(this,e)}return e}();L([Ut({type:tr})],Or.prototype,"base",void 0);L([Ut({type:nt.Integer,context:0,defaultValue:0,implicit:true})],Or.prototype,"minimum",void 0);L([Ut({type:nt.Integer,context:1,optional:true,implicit:true})],Or.prototype,"maximum",void 0);var Lr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Lr=L([Tt({type:rt.Sequence,itemType:Or})],Lr);var Dr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:Lr,context:0,optional:true,implicit:true})],Dr.prototype,"permittedSubtrees",void 0);L([Ut({type:Lr,context:1,optional:true,implicit:true})],Dr.prototype,"excludedSubtrees",void 0);var Hr=function(){function e(e){if(e===void 0){e={}}Object.assign(this,e)}return e}();L([Ut({type:nt.Integer,context:0,implicit:true,optional:true,converter:st})],Hr.prototype,"requireExplicitPolicy",void 0);L([Ut({type:nt.Integer,context:1,implicit:true,optional:true,converter:st})],Hr.prototype,"inhibitPolicyMapping",void 0);var Rr=function(){function e(e){if(e===void 0){e={}}this.issuerDomainPolicy="";this.subjectDomainPolicy="";Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],Rr.prototype,"issuerDomainPolicy",void 0);L([Ut({type:nt.ObjectIdentifier})],Rr.prototype,"subjectDomainPolicy",void 0);var Tr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(ur);Tr=L([Tt({type:rt.Sequence})],Tr);var Ur=function(){function e(e){if(e===void 0){e={}}this.type="";this.values=[];Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],Ur.prototype,"type",void 0);L([Ut({type:nt.Any,repeated:"set"})],Ur.prototype,"values",void 0);var Pr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Pr=L([Tt({type:rt.Sequence,itemType:Ur})],Pr);var jr=function(){function e(e){if(e===void 0){e={}}this.algorithm="";Object.assign(this,e)}return e}();L([Ut({type:nt.ObjectIdentifier})],jr.prototype,"algorithm",void 0);L([Ut({type:nt.Any,optional:true})],jr.prototype,"parameters",void 0);var Fr=function(){function e(e){if(e===void 0){e={}}this.algorithm=new jr;this.subjectPublicKey=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:jr})],Fr.prototype,"algorithm",void 0);L([Ut({type:nt.BitString})],Fr.prototype,"subjectPublicKey",void 0);var Vr=function(){function e(e){if(e){if(typeof e==="string"||typeof e==="number"){this.utcTime=new Date(e)}else if(e instanceof Date){this.utcTime=e}else{Object.assign(this,e)}}}e.prototype.getTime=function(){var e=this.utcTime||this.generalTime;if(!e){throw new Error("Cannot get time from CHOICE object")}return e};return e}();L([Ut({type:nt.UTCTime})],Vr.prototype,"utcTime",void 0);L([Ut({type:nt.GeneralizedTime})],Vr.prototype,"generalTime",void 0);Vr=L([Tt({type:rt.Choice})],Vr);var Mr=function(){function e(e){this.notBefore=new Vr(new Date);this.notAfter=new Vr(new Date);if(e){this.notBefore=new Vr(e.notBefore);this.notAfter=new Vr(e.notAfter)}}return e}();L([Ut({type:Vr})],Mr.prototype,"notBefore",void 0);L([Ut({type:Vr})],Mr.prototype,"notAfter",void 0);var Jr=function(){function e(t){if(t===void 0){t={}}this.extnID="";this.critical=e.CRITICAL;this.extnValue=new It;Object.assign(this,t)}return e}();Jr.CRITICAL=false;L([Ut({type:nt.ObjectIdentifier})],Jr.prototype,"extnID",void 0);L([Ut({type:nt.Boolean,defaultValue:Jr.CRITICAL})],Jr.prototype,"critical",void 0);L([Ut({type:It})],Jr.prototype,"extnValue",void 0);var Gr=function(e){__extends(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Vt);Gr=L([Tt({type:rt.Sequence,itemType:Jr})],Gr);var zr;(function(e){e[e["v1"]=0]="v1";e[e["v2"]=1]="v2";e[e["v3"]=2]="v3"})(zr||(zr={}));var Wr=function(){function e(e){if(e===void 0){e={}}this.version=zr.v1;this.serialNumber=new ArrayBuffer(0);this.signature=new jr;this.issuer=new Yt;this.validity=new Mr;this.subject=new Yt;this.subjectPublicKeyInfo=new Fr;Object.assign(this,e)}return e}();L([Ut({type:nt.Integer,context:0,defaultValue:zr.v1})],Wr.prototype,"version",void 0);L([Ut({type:nt.Integer,converter:st})],Wr.prototype,"serialNumber",void 0);L([Ut({type:jr})],Wr.prototype,"signature",void 0);L([Ut({type:Yt})],Wr.prototype,"issuer",void 0);L([Ut({type:Mr})],Wr.prototype,"validity",void 0);L([Ut({type:Yt})],Wr.prototype,"subject",void 0);L([Ut({type:Fr})],Wr.prototype,"subjectPublicKeyInfo",void 0);L([Ut({type:nt.BitString,context:1,implicit:true,optional:true})],Wr.prototype,"issuerUniqueID",void 0);L([Ut({type:nt.BitString,context:2,implicit:true,optional:true})],Wr.prototype,"subjectUniqueID",void 0);L([Ut({type:Jr,context:3,optional:true,repeated:"sequence"})],Wr.prototype,"extensions",void 0);var qr=function(){function e(e){if(e===void 0){e={}}this.tbsCertificate=new Wr;this.signatureAlgorithm=new jr;this.signatureValue=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:Wr})],qr.prototype,"tbsCertificate",void 0);L([Ut({type:jr})],qr.prototype,"signatureAlgorithm",void 0);L([Ut({type:nt.BitString})],qr.prototype,"signatureValue",void 0);var $r=function(){function e(e){if(e===void 0){e={}}this.userCertificate=new ArrayBuffer(0);this.revocationDate=new Vr;Object.assign(this,e)}return e}();L([Ut({type:nt.Integer,converter:st})],$r.prototype,"userCertificate",void 0);L([Ut({type:Vr})],$r.prototype,"revocationDate",void 0);L([Ut({type:Jr,optional:true,repeated:"sequence"})],$r.prototype,"crlEntryExtensions",void 0);var Zr=function(){function e(e){if(e===void 0){e={}}this.signature=new jr;this.issuer=new Yt;this.thisUpdate=new Vr;Object.assign(this,e)}return e}();L([Ut({type:nt.Integer,optional:true})],Zr.prototype,"version",void 0);L([Ut({type:jr})],Zr.prototype,"signature",void 0);L([Ut({type:Yt})],Zr.prototype,"issuer",void 0);L([Ut({type:Vr})],Zr.prototype,"thisUpdate",void 0);L([Ut({type:Vr,optional:true})],Zr.prototype,"nextUpdate",void 0);L([Ut({type:$r,repeated:"sequence",optional:true})],Zr.prototype,"revokedCertificates",void 0);L([Ut({type:Jr,optional:true,context:0,repeated:"sequence"})],Zr.prototype,"crlExtensions",void 0);var Kr=function(){function e(e){if(e===void 0){e={}}this.tbsCertList=new Zr;this.signatureAlgorithm=new jr;this.signature=new ArrayBuffer(0);Object.assign(this,e)}return e}();L([Ut({type:Zr})],Kr.prototype,"tbsCertList",void 0);L([Ut({type:jr})],Kr.prototype,"signatureAlgorithm",void 0);L([Ut({type:nt.BitString})],Kr.prototype,"signature",void 0);var Yr=function(){function e(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}if(e.length===1){this.asn=e[0];this.rawData=Mt.serialize(this.asn)}else{this.asn=Mt.parse(e[0],e[1]);this.rawData=s.toArrayBuffer(e[0])}}return e}();var Qr=function(e){__extends(t,e);function t(t){var r=e.call(this,t,Jr)||this;switch(r.asn.extnID){case Cr:r.value=jt.parse(r.asn.extnValue,Ir);break;default:r.value=r.asn.extnValue}return r}return t}(Yr);var Xr=function(e){__extends(t,e);function t(t){var r=e.call(this,t,qr)||this;r.parseExtensions();return r}t.prototype.parseExtensions=function(){var e=this.asn.tbsCertificate;if(e.extensions){this.extensions=e.extensions.map((function(e){return new Qr(Mt.serialize(e))}))}};t.prototype.hasKeyUsage=function(e){if(!e||!e.length||!this.extensions.length){return false}var t;for(var r=0;r<this.extensions.length;r+=1){if(this.extensions[r].value instanceof Ir){t=this.extensions[r].value;break}}if(!t){return false}var n=t.toJSON();var i=__spreadArrays(e);for(var r=0;r<n.length;r+=1){if(i.length){var o=i.indexOf(n[r]);if(o!==-1){i.splice(o,1)}}else{break}}if(!i.length){return true}return false};return t}(Yr);var en="127.0.0.1:31337";var tn=1e4;var rn;(function(e){e["PROVIDERS_ADDED"]="providers:added";e["PROVIDERS_REMOVED"]="providers:removed";e["CLOSE"]="close";e["CONNECTION_PENDING"]="connection:pending";e["CONNECTION_RESOLVED"]="connection:resolved";e["CONNECTION_NOT_SUPPORTED"]="connection:not_supported";e["CONNECTION_REJECTED"]="connection:rejected";e["CHALLENGE_PENDING"]="challenge:pending";e["CHALLENGE_RESOLVED"]="challenge:resolved";e["CHALLENGE_REJECTED"]="challenge:rejected";e["DATA_CERTIFICATES_PENDING"]="data:certificates:pending";e["DATA_CERTIFICATES_RESOLVED"]="data:certificates:resolved";e["DATA_PROVIDERS_PENDING"]="data:providers:pending";e["DATA_PROVIDERS_RESOLVED"]="data:providers:resolved"})(rn||(rn={}));if(!Uint8Array.prototype.slice){Object.defineProperty(Uint8Array.prototype,"slice",{value:function(e,t){return new Uint8Array(Array.prototype.slice.call(this,e,t))}})}var nn=function(){return __awaiter(v,void 0,void 0,(function(){var e,r,n,i;return __generator(this,(function(o){switch(o.label){case 0:if(!!window["asmCrypto"])return[3,2];e=window;r="asmCrypto";return[4,t.import("./p-5afd9692.system.js")];case 1:e[r]=o.sent();o.label=2;case 2:if(!!window["elliptic"])return[3,4];n=window;i="elliptic";return[4,t.import("./p-562118e2.system.js")];case 3:n[i]=o.sent().default;o.label=4;case 4:return[4,t.import("./p-bbaf40db.system.js")];case 5:o.sent();if(!!window["protobuf"])return[3,7];return[4,t.import("./p-007f6e34.system.js")];case 6:o.sent();o.label=7;case 7:if(!!window["WebcryptoSocket"])return[3,9];return[4,t.import("./p-8c1a4e1a.system.js")];case 8:o.sent();o.label=9;case 9:return[2]}}))}))};var on=undefined&&undefined.__classPrivateFieldGet||function(e,t){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return t.get(e)};var an=undefined&&undefined.__classPrivateFieldSet||function(e,t,r){if(!t.has(e)){throw new TypeError("attempted to set private field on non-instance")}t.set(e,r);return r};var sn,un,ln,cn,fn;var hn=function(){function e(e){sn.set(this,void 0);un.set(this,void 0);ln.set(this,O(window.navigator));cn.set(this,void 0);fn.set(this,"");this.options={logger:function(){},filters:{}};if(e.logger){this.options.logger=e.logger}if(e.filters){this.options.filters=e.filters}}e.prototype.isConnectionSupported=function(){return!on(this,ln).phone};e.prototype.getServer=function(){return on(this,sn)};e.hasConnection=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:r.trys.push([0,2,,3]);return[4,fetch("https://"+en+"/.well-known/webcrypto-socket")];case 1:e=r.sent();return[2,e.ok];case 2:t=r.sent();return[2,false];case 3:return[2]}}))}))};e.prototype.checkHasConnection=function(){return __awaiter(this,void 0,void 0,(function(){var t=this;return __generator(this,(function(r){return[2,new Promise((function(r){var n=function(){return __awaiter(t,void 0,void 0,(function(){var t;return __generator(this,(function(i){switch(i.label){case 0:return[4,e.hasConnection()];case 1:t=i.sent();if(t){r()}else{an(this,cn,window.setTimeout(n,tn))}return[2]}}))}))};n()}))]}))}))};e.prototype.tryChallenge=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:return[4,on(this,sn).isLoggedIn()];case 1:e=t.sent();if(!e){return[2,on(this,sn).challenge()]}return[2,null]}}))}))};e.prototype.login=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,on(this,sn).login()];case 1:e.sent();return[2]}}))}))};e.prototype.connect=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,r;var n=this;return __generator(this,(function(i){switch(i.label){case 0:return[4,nn()];case 1:i.sent();if(!!on(this,un))return[3,5];i.label=2;case 2:i.trys.push([2,4,,5]);e=an;t=[this,un];return[4,WebcryptoSocket.BrowserStorage.create()];case 3:e.apply(void 0,t.concat([i.sent()]));return[3,5];case 4:r=i.sent();an(this,un,new WebcryptoSocket.MemoryStorage);return[3,5];case 5:return[2,new Promise((function(e,t){if(on(n,sn)){e()}an(n,sn,new WebcryptoSocket.SocketProvider({storage:on(n,un)}).connect(en).on("error",(function(e){console.log(e);t()})).on("listening",(function(){return __awaiter(n,void 0,void 0,(function(){return __generator(this,(function(t){e();return[2]}))}))})).on("token",(function(e){return __awaiter(n,void 0,void 0,(function(){return __generator(this,(function(t){if(e.added.length){this.options.logger(rn.PROVIDERS_ADDED,e.added)}if(e.removed.length){this.options.logger(rn.PROVIDERS_REMOVED,e.removed)}return[2]}))}))})).on("disconnect",(function(){console.log("disconnect")})).on("close",(function(){n.options.logger(rn.CLOSE)})))}))]}}))}))};e.prototype.disconnect=function(){if(on(this,sn)){on(this,sn).client.close();an(this,sn,null)}if(on(this,cn)){clearTimeout(on(this,cn));an(this,cn,null)}};e.prototype.start=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:this.options.logger(rn.CONNECTION_PENDING);if(!this.isConnectionSupported()){this.options.logger(rn.CONNECTION_NOT_SUPPORTED);return[2]}return[4,e.hasConnection()];case 1:if(!t.sent()){this.options.logger(rn.CONNECTION_REJECTED)}return[4,this.checkHasConnection()];case 2:t.sent();return[4,this.connect()];case 3:t.sent();return[4,this.tryLogin()];case 4:t.sent();return[2]}}))}))};e.prototype.tryLogin=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(r){switch(r.label){case 0:return[4,this.tryChallenge()];case 1:e=r.sent();if(!e)return[3,5];an(this,fn,e);this.options.logger(rn.CHALLENGE_PENDING);r.label=2;case 2:r.trys.push([2,4,,5]);return[4,this.login()];case 3:r.sent();an(this,fn,undefined);this.options.logger(rn.CHALLENGE_RESOLVED);return[3,5];case 4:t=r.sent();an(this,fn,undefined);this.options.logger(rn.CHALLENGE_REJECTED);return[2];case 5:this.options.logger(rn.CONNECTION_RESOLVED);return[2]}}))}))};e.prototype.getChallenge=function(){return on(this,fn)};e.prototype.isProviderValid=function(e){var t=this.options.filters;if(t&&t.onlyRemote&&!e.isRemovable){return false}return true};e.prototype.getProvidersInfo=function(){return __awaiter(this,void 0,void 0,(function(){var e;var t=this;return __generator(this,(function(r){switch(r.label){case 0:return[4,on(this,sn).info()];case 1:e=r.sent();return[2,e.providers.filter((function(e){return t.isProviderValid(e)}))]}}))}))};e.prototype.getProviderById=function(e){return __awaiter(this,void 0,void 0,(function(){var t,r,n;return __generator(this,(function(i){switch(i.label){case 0:return[4,on(this,sn).getCrypto(e)];case 1:t=i.sent();return[4,t.isLoggedIn()];case 2:r=i.sent();if(!!r)return[3,6];i.label=3;case 3:i.trys.push([3,5,,6]);return[4,t.login()];case 4:i.sent();return[3,6];case 5:n=i.sent();return[2,undefined];case 6:return[2,t]}}))}))};e.prototype.certificatePreFilter=function(e,t){if(e.split("-")[0]!=="x509"){return false}var r=t.filter((function(t){var r=t.split("-");return r[0]==="private"&&r[2]===e.split("-")[2]}))[0];if(!r){return false}return r};e.prototype.certificateFilter=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n,i,o;return __generator(this,(function(a){switch(a.label){case 0:r=this.options.filters;if(!r.expired&&e.notAfter.getTime()<Date.now()){return[2,false]}if(r.subjectDNMatch){if(typeof r.subjectDNMatch==="string"&&!e.subjectName.includes(r.subjectDNMatch)){return[2,false]}if(r.subjectDNMatch instanceof RegExp&&!r.subjectDNMatch.test(e.subjectName)){return[2,false]}}if(r.issuerDNMatch){if(typeof r.issuerDNMatch==="string"&&!e.issuerName.includes(r.issuerDNMatch)){return[2,false]}if(r.issuerDNMatch instanceof RegExp&&!r.issuerDNMatch.test(e.issuerName)){return[2,false]}}if(!(r.keyUsage&&r.keyUsage.length))return[3,2];return[4,t.certStorage.exportCert("raw",e)];case 1:n=a.sent();i=new Xr(n);o=i.hasKeyUsage(this.options.filters.keyUsage);if(!o){return[2,false]}a.label=2;case 2:return[2,true]}}))}))};e.prototype.getCertificatesById=function(t){return __awaiter(this,void 0,void 0,(function(){var r,n,i,o,a,s,u,l,c,f,h;return __generator(this,(function(v){switch(v.label){case 0:return[4,this.getProviderById(t)];case 1:r=v.sent();if(!r){return[2,undefined]}n=[];return[4,r.keyStorage.keys()];case 2:i=v.sent();return[4,r.certStorage.keys()];case 3:o=v.sent();a=0,s=o;v.label=4;case 4:if(!(a<s.length))return[3,11];u=s[a];l=this.certificatePreFilter(u,i);if(!l){return[3,10]}c=void 0;v.label=5;case 5:v.trys.push([5,7,,8]);return[4,r.certStorage.getItem(u)];case 6:c=v.sent();return[3,8];case 7:f=v.sent();console.warn("Can't read certificate: "+u);return[3,10];case 8:return[4,this.certificateFilter(c,r)];case 9:h=v.sent();if(!h){return[3,10]}c.id=u;c.subject=e.getSubjectIssuerValue(c.subjectName);c.issuer=e.getSubjectIssuerValue(c.issuerName);c.privateKeyId=l;n.push(c);v.label=10;case 10:a++;return[3,4];case 11:return[2,n]}}))}))};e.prototype.getCertificateBodyById=function(e,t){return __awaiter(this,void 0,void 0,(function(){var r,n,i;return __generator(this,(function(o){switch(o.label){case 0:return[4,this.getProviderById(e)];case 1:r=o.sent();if(!r){return[2,undefined]}return[4,r.certStorage.getItem(t)];case 2:n=o.sent();return[4,r.certStorage.exportCert("raw",n)];case 3:i=o.sent();return[2,c.ToBase64(i)]}}))}))};e.getSubjectIssuerValue=function(e){var t={};var r=e.split(/, /g);r.forEach((function(e){var r=e.split("=");t[r[0]]=r[1]}));return t};return e}();sn=new WeakMap,un=new WeakMap,ln=new WeakMap,cn=new WeakMap,fn=new WeakMap;var vn=undefined&&undefined.__classPrivateFieldSet||function(e,t,r){if(!t.has(e)){throw new TypeError("attempted to set private field on non-instance")}t.set(e,r);return r};var pn=undefined&&undefined.__classPrivateFieldGet||function(e,t){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return t.get(e)};var dn;var gn=function(){function e(e){this.certificates=[];this.providers=[];dn.set(this,void 0);vn(this,dn,new hn(e))}e.prototype.start=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,pn(this,dn).start()];case 1:e.sent();return[2]}}))}))};e.prototype.tryLogin=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:return[4,pn(this,dn).tryLogin()];case 1:e.sent();return[2]}}))}))};e.prototype.getCertificateBodyById=function(e,t){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(r){return[2,pn(this,dn).getCertificateBodyById(e,t)]}))}))};e.prototype.getServer=function(){return pn(this,dn).getServer()};e.prototype.getChallenge=function(){return pn(this,dn).getChallenge()};e.prototype.finish=function(){pn(this,dn).disconnect();this.certificates=[];this.providers=[]};e.prototype.selectCertificate=function(e){this.certificates=this.certificates.map((function(t){var r=false;if(t.id===e){r=true}Object.assign(t,{selected:r});return t}))};e.prototype.getSelectedCertificate=function(){return this.certificates.find((function(e){return e.selected}))};e.prototype.dataCertificates=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,r,n;var i;return __generator(this,(function(o){switch(o.label){case 0:this.certificates=[];if(this.providers.length===0){return[2]}pn(this,dn).options.logger(rn.DATA_CERTIFICATES_PENDING);e=0,t=this.providers;o.label=1;case 1:if(!(e<t.length))return[3,4];r=t[e];return[4,pn(this,dn).getCertificatesById(r.id)];case 2:n=o.sent();if(n){(i=this.certificates).push.apply(i,n)}o.label=3;case 3:e++;return[3,1];case 4:pn(this,dn).options.logger(rn.DATA_CERTIFICATES_RESOLVED);return[2]}}))}))};e.prototype.dataProviders=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:pn(this,dn).options.logger(rn.DATA_PROVIDERS_PENDING);e=this;return[4,pn(this,dn).getProvidersInfo()];case 1:e.providers=t.sent();pn(this,dn).options.logger(rn.DATA_PROVIDERS_RESOLVED);return[2]}}))}))};return e}();dn=new WeakMap;var yn="*{-webkit-box-sizing:border-box;box-sizing:border-box}.peculiar_stroke_dark{border-color:#40484f;border-color:rgb(var(--peculiar-color-dark-rgb, 64, 72, 79))}.peculiar_fill_dark{background-color:#40484f;background-color:rgb(var(--peculiar-color-dark-rgb, 64, 72, 79))}.peculiar_color_dark{color:#40484f;color:rgb(var(--peculiar-color-dark-rgb, 64, 72, 79))}.peculiar_stroke_light{border-color:#ffffff;border-color:rgb(var(--peculiar-color-light-rgb, 255, 255, 255))}.peculiar_fill_light{background-color:#ffffff;background-color:rgb(var(--peculiar-color-light-rgb, 255, 255, 255))}.peculiar_color_light{color:#ffffff;color:rgb(var(--peculiar-color-light-rgb, 255, 255, 255))}.peculiar_stroke_grey_1{border-color:#FAF9F9;border-color:rgb(var(--peculiar-color-grey_1-rgb, 250, 249, 249))}.peculiar_fill_grey_1{background-color:#FAF9F9;background-color:rgb(var(--peculiar-color-grey_1-rgb, 250, 249, 249))}.peculiar_color_grey_1{color:#FAF9F9;color:rgb(var(--peculiar-color-grey_1-rgb, 250, 249, 249))}.peculiar_stroke_grey_2{border-color:#EEF4F7;border-color:rgb(var(--peculiar-color-grey_2-rgb, 238, 244, 247))}.peculiar_fill_grey_2{background-color:#EEF4F7;background-color:rgb(var(--peculiar-color-grey_2-rgb, 238, 244, 247))}.peculiar_color_grey_2{color:#EEF4F7;color:rgb(var(--peculiar-color-grey_2-rgb, 238, 244, 247))}.peculiar_stroke_grey_3{border-color:#E1E4E6;border-color:rgb(var(--peculiar-color-grey_3-rgb, 225, 228, 230))}.peculiar_fill_grey_3{background-color:#E1E4E6;background-color:rgb(var(--peculiar-color-grey_3-rgb, 225, 228, 230))}.peculiar_color_grey_3{color:#E1E4E6;color:rgb(var(--peculiar-color-grey_3-rgb, 225, 228, 230))}.peculiar_stroke_grey_4{border-color:#b6c3cc;border-color:rgb(var(--peculiar-color-grey_4-rgb, 182, 195, 204))}.peculiar_fill_grey_4{background-color:#b6c3cc;background-color:rgb(var(--peculiar-color-grey_4-rgb, 182, 195, 204))}.peculiar_color_grey_4{color:#b6c3cc;color:rgb(var(--peculiar-color-grey_4-rgb, 182, 195, 204))}.peculiar_stroke_grey_5{border-color:#6d7d87;border-color:rgb(var(--peculiar-color-grey_5-rgb, 109, 125, 135))}.peculiar_fill_grey_5{background-color:#6d7d87;background-color:rgb(var(--peculiar-color-grey_5-rgb, 109, 125, 135))}.peculiar_color_grey_5{color:#6d7d87;color:rgb(var(--peculiar-color-grey_5-rgb, 109, 125, 135))}.peculiar_stroke_secondary{border-color:#0abe65;border-color:rgb(var(--peculiar-color-secondary-rgb, 10, 190, 101))}.peculiar_fill_secondary{background-color:#0abe65;background-color:rgb(var(--peculiar-color-secondary-rgb, 10, 190, 101))}.peculiar_color_secondary{color:#0abe65;color:rgb(var(--peculiar-color-secondary-rgb, 10, 190, 101))}.peculiar_stroke_primary{border-color:#0680ff;border-color:rgb(var(--peculiar-color-primary-rgb, 6, 128, 255))}.peculiar_fill_primary{background-color:#0680ff;background-color:rgb(var(--peculiar-color-primary-rgb, 6, 128, 255))}.peculiar_color_primary{color:#0680ff;color:rgb(var(--peculiar-color-primary-rgb, 6, 128, 255))}.peculiar_stroke_attention{border-color:#F7A831;border-color:rgb(var(--peculiar-color-attention-rgb, 247, 168, 49))}.peculiar_fill_attention{background-color:#F7A831;background-color:rgb(var(--peculiar-color-attention-rgb, 247, 168, 49))}.peculiar_color_attention{color:#F7A831;color:rgb(var(--peculiar-color-attention-rgb, 247, 168, 49))}.peculiar_h4{font-size:17px;line-height:1.4;font-weight:600;letter-spacing:0.188889px}.peculiar_h6{font-size:15px;line-height:20px;font-weight:600;letter-spacing:0.3px}.peculiar_h7{font-size:14px;line-height:1.35;font-weight:600;letter-spacing:0px}.peculiar_b1{font-size:15px;line-height:1.46;font-weight:400;letter-spacing:0.3px}.peculiar_b3{font-size:13px;line-height:1.5;font-weight:400;letter-spacing:0.03em}.peculiar_c1{font-size:11px;line-height:1.36;font-weight:400;letter-spacing:0.03em}peculiar-fortify-button+peculiar-fortify-button{margin-left:10px}:host{display:block}.container_details{position:absolute;width:100%;height:100%;top:0;left:0;z-index:1}.container_details_header{border-bottom-width:1px;border-bottom-style:solid;padding:10px 100px;position:relative;height:45px}.container_details_button{position:absolute;top:50%;left:8px;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.container_details_content{height:calc(100% - 45px);overflow:auto}";var mn=undefined&&undefined.__classPrivateFieldGet||function(e,t){if(!t.has(e)){throw new TypeError("attempted to get private field on non-instance")}return t.get(e)};var bn=undefined&&undefined.__classPrivateFieldSet||function(e,t,r){if(!t.has(e)){throw new TypeError("attempted to set private field on non-instance")}t.set(e,r);return r};var kn;var Bn=e("peculiar_fortify_certificates",function(){function e(e){var t=this;r(this,e);kn.set(this,void 0);this.filters={};this.action=rn.CONNECTION_PENDING;this.tick=0;this.onLog=function(e,r){return __awaiter(t,void 0,void 0,(function(){return __generator(this,(function(t){switch(t.label){case 0:if(this.debug){console.log({type:e,body:r})}if(!(e===rn.PROVIDERS_ADDED||e===rn.PROVIDERS_REMOVED))return[3,2];return[4,mn(this,kn).dataProviders()];case 1:t.sent();return[2];case 2:this.action=e;if(e===rn.CONNECTION_RESOLVED){mn(this,kn).dataProviders()}if(e===rn.DATA_PROVIDERS_RESOLVED){mn(this,kn).dataCertificates()}return[2]}}))}))};this.onClickCancel=function(){t.cancel.emit()};this.onClickContinue=function(){var e=mn(t,kn).getSelectedCertificate();if(e){t.continue.emit({certificateId:e.id,providerId:e.providerID,server:mn(t,kn).getServer(),privateKeyId:e.privateKeyId})}};this.onClickUpdateCertificates=function(){mn(t,kn).dataCertificates()};this.onClickTryAgain=function(){mn(t,kn).tryLogin()};this.onClickCloseDetails=function(){t.certificateBase64ForDetails=null};this.onClickCertificate=function(e){mn(t,kn).selectCertificate(e);t.tick+=1};this.onClickCertificateDetails=function(e,r){mn(t,kn).getCertificateBodyById(e,r).then((function(e){t.certificateBase64ForDetails=e}))};this.cancel=n(this,"cancel",7);this.continue=n(this,"continue",7)}e.prototype.componentWillLoad=function(){f.setLocale(this.language)};e.prototype.componentDidLoad=function(){return __awaiter(this,void 0,void 0,(function(){return __generator(this,(function(e){switch(e.label){case 0:bn(this,kn,new gn({logger:this.onLog,filters:this.filters}));return[4,mn(this,kn).start()];case 1:e.sent();return[2]}}))}))};e.prototype.componentDidUnload=function(){mn(this,kn).finish()};e.renderConnecting=function(){return i("peculiar-fortify-connecting",null)};e.renderFortifyAuthorization=function(e){return i("peculiar-fortify-authorization",{pin:e})};e.renderFortifyNotDetected=function(){return i("peculiar-fortify-not-detected",null)};e.renderFortifyNotSupported=function(){return i("peculiar-fortify-not-supported",null)};e.prototype.renderChallengeNotApproved=function(){return i("peculiar-fortify-challenge-not-approved",{onCancel:this.onClickCancel,onTryAgain:this.onClickTryAgain})};e.prototype.renderCertificates=function(){var e=this.action===rn.DATA_CERTIFICATES_PENDING;var t;if(!e){t=mn(this,kn).getSelectedCertificate()}return i("peculiar-fortify-certificates-list",{certificates:mn(this,kn).certificates,onCertificate:this.onClickCertificate,onCertificateDetails:this.onClickCertificateDetails,onUpdate:this.onClickUpdateCertificates,onCancel:this.onClickCancel,onContinue:this.onClickContinue,loading:e,allowContinue:t})};e.prototype.renderProvidersEmpty=function(){return i("peculiar-fortify-providers-empty",{onCancel:this.onClickCancel})};e.prototype.renderUnresolvedStatus=function(){return i("peculiar-fortify-layout",{type:"message",titleValue:"Someting went wrong for status",descriptionValue:this.action})};e.prototype.render=function(){var e=null;switch(this.action){case rn.CONNECTION_PENDING:case rn.CONNECTION_RESOLVED:case rn.DATA_PROVIDERS_PENDING:e=Bn.renderConnecting();break;case rn.CONNECTION_REJECTED:case rn.CLOSE:e=Bn.renderFortifyNotDetected();this.certificateBase64ForDetails=null;break;case rn.CONNECTION_NOT_SUPPORTED:e=Bn.renderFortifyNotSupported();break;case rn.CHALLENGE_PENDING:e=Bn.renderFortifyAuthorization(mn(this,kn).getChallenge());break;case rn.CHALLENGE_REJECTED:e=this.renderChallengeNotApproved();break;case rn.DATA_PROVIDERS_RESOLVED:if(mn(this,kn).providers.length===0){e=this.renderProvidersEmpty()}break;case rn.DATA_CERTIFICATES_PENDING:case rn.DATA_CERTIFICATES_RESOLVED:e=this.renderCertificates();break;default:e=this.renderUnresolvedStatus()}if(this.action===rn.DATA_PROVIDERS_PENDING&&mn(this,kn).providers.length){e=this.renderCertificates()}return i(a,null,i("peculiar-fortify-layout",null,this.certificateBase64ForDetails&&i("div",{class:"container_details peculiar_fill_light"},i("header",{class:"container_details_header peculiar_stroke_grey_3"},i("peculiar-fortify-typography",{type:"h4",align:"center",ellipsis:true},h("details.title")),i("peculiar-fortify-button",{class:"container_details_button",onClick:this.onClickCloseDetails,"aria-label":"Close details",size:"small"},i("img",{slot:"icon",src:o("../assets/back_icon.svg"),alt:"Back"}),h("actions.back"))),i("div",{class:"container_details_content"},i("peculiar-certificate-viewer",{certificate:this.certificateBase64ForDetails,view:"mobile"}))),e))};Object.defineProperty(e,"assetsDirs",{get:function(){return["../../assets"]},enumerable:true,configurable:true});return e}());kn=new WeakMap;Bn.style=yn}}}));